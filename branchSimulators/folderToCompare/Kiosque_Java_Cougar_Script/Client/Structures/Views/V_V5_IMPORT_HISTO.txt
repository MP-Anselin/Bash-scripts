##
V_V5_IMPORT_HISTO
=SQL=
CREATE OR REPLACE VIEW V_V5_IMPORT_HISTO ("APPLI","BO_HISTO_COL_NAME","KSQ_HISTO_COL_NAME","DATA_TYPE","LIBELLE","VIS_FORCE_RESET_HISTO","VIS_SRC_TABLE_NAME","VIS_SRC_COL_NAME","VIS_SRC_DATE_DEBUT","VIS_SRC_DATE_FIN","VIS_SRC_MATRICULE","HRV_FORCE_RESET_HISTO","HRV_SRC_TABLE_NAME","HRV_SRC_COL_NAME","HRV_SRC_DATE_DEBUT","HRV_SRC_DATE_FIN","HRV_SRC_MATRICULE","Z2X_FORCE_RESET_HISTO","Z2X_SRC_TABLE_NAME","Z2X_SRC_COL_NAME","Z2X_SRC_DATE_DEBUT","Z2X_SRC_DATE_FIN","Z2X_SRC_MATRICULE") AS 
select mdl_hist.APPLI
     , mdl_hist.BO_HISTO_COL_NAME
     , mdl_hist.KSQ_HISTO_COL_NAME
     , mdl_hist.DATA_TYPE
     , mdl_hist.LIBELLE
     , mdl_hist.VIS_FORCE_RESET_HISTO
     , imp_vis.SOURCE_TABLE as VIS_SRC_TABLE_NAME
     , imp_vis.SOURCE_COLUMN as VIS_SRC_COL_NAME
     , imp_vis.SOURCE_COLUMN_DDEB as VIS_SRC_DATE_DEBUT
     , imp_vis.SOURCE_COLUMN_DFIN as VIS_SRC_DATE_FIN
     , imp_vis.SOURCE_COLUMN_ID as VIS_SRC_MATRICULE
     , mdl_hist.HRV_FORCE_RESET_HISTO
     , imp_hrv.SOURCE_TABLE as HRV_SRC_TABLE_NAME
     , imp_hrv.SOURCE_COLUMN as HRV_SRC_COL_NAME
     , imp_hrv.SOURCE_COLUMN_DDEB as HRV_SRC_DATE_DEBUT
     , imp_hrv.SOURCE_COLUMN_DFIN as HRV_SRC_DATE_FIN
     , imp_hrv.SOURCE_COLUMN_ID as HRV_SRC_MATRICULE
     , mdl_hist.Z2X_FORCE_RESET_HISTO
     , mdl_hist.Z2X_SRC_TABLE_NAME
     , mdl_hist.Z2X_SRC_COL_NAME
     , mdl_hist.Z2X_SRC_DATE_DEBUT
     , mdl_hist.Z2X_SRC_DATE_FIN
     , mdl_hist.Z2X_SRC_MATRICULE
  from KRHMODELE.V_MDL_IMPORT_HISTO mdl_hist
  left join V_V5_IMPORT_STATION imp_vis
    on (imp_vis.APPLI = mdl_hist.APPLI
        and imp_vis.TARGET_HISTO_COLUMN = mdl_hist.BO_HISTO_COL_NAME
        and imp_vis.IMPORT_TYPE = 'VIS')
  left join V_V5_IMPORT_STATION imp_hrv
    on (imp_hrv.APPLI = mdl_hist.APPLI
        and imp_hrv.TARGET_HISTO_COLUMN = mdl_hist.BO_HISTO_COL_NAME
        and imp_hrv.IMPORT_TYPE = 'HRV')

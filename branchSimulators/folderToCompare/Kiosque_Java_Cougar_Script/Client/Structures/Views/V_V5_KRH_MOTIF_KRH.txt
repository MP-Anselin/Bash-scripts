##
V_V5_KRH_MOTIF_KRH
=SQL=
CREATE OR REPLACE VIEW V_V5_KRH_MOTIF_KRH ("PERSO","COMMENTAIRE","EST_FORMATION","EXPORT_STATION","EXPORT_GTA","DIF_CATEGORIE","MOTIF","LANGUE","DIF","LIBELLE","MOTIF_EN_PAIE","MOTIF_EN_PAIE_DJ","MODE_CONVERSION","NBRE_MAX","MOIS_DEB_PER","MAX_NON_DEPASSABLE","DESCRIPTION","JOUR_COMPLET","COMMENTAIRE_OBLIGATOIRE","SOLDE_MINI","EST_CP2","EST_CP1","EST_CP3","EN_JOURS_CALENDAIRES","VISIBLE_AUTODECLAR","CODE_ABS_PRES","DIF_MODALITE","DIF_HORS_TEMPS_TRAV","DIF_PERIODE_PROF","CIF","VISIBLEFORMATION","MOTIFENPAIEGTA","MOTIFENPAIEDJGTA","MOTEURPAIE","CPF") AS 
select 0 as PERSO, '' as COMMENTAIRE, 
 VISIBLEFORMATION as EST_FORMATION, 
 case when MOTIF_EN_PAIE is not null or MOTIF_EN_PAIE_DJ is not null then 1 else 0 end as EXPORT_STATION, 
 case when MOTIFENPAIEGTA is not null or MOTIFENPAIEDJGTA is not null then 1 else 0 end as EXPORT_GTA, 
 DIF_CATEGORIE 
, MOTIF
, LANGUE
, DIF
, LIBELLE
, MOTIF_EN_PAIE
, MOTIF_EN_PAIE_DJ
, MODE_CONVERSION
, NBRE_MAX
, MOIS_DEB_PER
, MAX_NON_DEPASSABLE
, DESCRIPTION
, JOUR_COMPLET
, COMMENTAIRE_OBLIGATOIRE
, SOLDE_MINI
, EST_CP2
, EST_CP1
, EST_CP3
, EN_JOURS_CALENDAIRES
, VISIBLE_AUTODECLAR
, CODE_ABS_PRES
, DIF_MODALITE
, DIF_HORS_TEMPS_TRAV
, DIF_PERIODE_PROF
, CIF
, VISIBLEFORMATION
, MOTIFENPAIEGTA
, MOTIFENPAIEDJGTA
, MOTEURPAIE
, CPF
 from T_V5_MDL_MOTIF_KRH where MOTIF not in (select MOTIF from T_V5_KRH_MOTIF_KRH) union all  select 1 as PERSO, COMMENTAIRE, 
 VISIBLEFORMATION as EST_FORMATION, 
 NVL(EXPORT_STATION, 0) as EXPORT_STATION, NVL(EXPORT_GTA, 0) as EXPORT_GTA, 
 DIF_CATEGORIE 
, MOTIF
, LANGUE
, DIF
, LIBELLE
, MOTIF_EN_PAIE
, MOTIF_EN_PAIE_DJ
, MODE_CONVERSION
, NBRE_MAX
, MOIS_DEB_PER
, MAX_NON_DEPASSABLE
, DESCRIPTION
, JOUR_COMPLET
, COMMENTAIRE_OBLIGATOIRE
, SOLDE_MINI
, EST_CP2
, EST_CP1
, EST_CP3
, EN_JOURS_CALENDAIRES
, VISIBLE_AUTODECLAR
, CODE_ABS_PRES
, DIF_MODALITE
, DIF_HORS_TEMPS_TRAV
, DIF_PERIODE_PROF
, CIF
, VISIBLEFORMATION
, MOTIFENPAIEGTA
, MOTIFENPAIEDJGTA
, MOTEURPAIE
, CPF
 from T_V5_KRH_MOTIF_KRH order by MOTIF

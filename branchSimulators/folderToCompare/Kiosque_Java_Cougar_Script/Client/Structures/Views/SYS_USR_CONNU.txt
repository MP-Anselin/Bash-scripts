##
SYS_USR_CONNU
=SQL=
CREATE OR REPLACE VIEW SYS_USR_CONNU AS
SELECT
    UPPER(T.VALEUR) AS LOGIN,
    S.PRENOM
    || DECODE(S.PRENOM, NULL, NULL, ' ')
    || S.NOM AS NOMLONG,
    NULL AS MOTDEPASSE,
    U.DATE_CONNEXION   AS DERNIERECONNEXION,
    NULL AS DATECHPASSWORD,
    CASE
        WHEN DATE_SORTIE IS NULL
             OR DATE_SORTIE > SYSDATE
             OR TO_DATE(DATE_SORTIE, 'YYYYMMDD') = TO_DATE(SYSDATE, 'YYYYMMDD') THEN
            1
        ELSE
            0
    END AS ACTIF,
    NULL AS FILLER,
    NULL AS DATEFINACCES,
    U.DATE_CREATION    AS DATE_CREATE,
    U.DATE_MODIF       AS DATE_MAJ
FROM
    T_V5_KRH_SALARIE_IO_TYPE   T
    LEFT JOIN T_V5_KRH_SALARIE           S ON T.MATRICULE = S.MATRICULE
    INNER JOIN T_V5_KRH_USER              U ON T.MATRICULE = U.MATRICULE
WHERE
    TYPE = 'AOID'

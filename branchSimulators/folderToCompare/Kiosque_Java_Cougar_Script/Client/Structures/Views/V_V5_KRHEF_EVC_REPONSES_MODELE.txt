##
V_V5_KRHEF_EVC_REPONSES_MODELE
=SQL=
CREATE OR REPLACE VIEW V_V5_KRHEF_EVC_REPONSES_MODELE ("FORM_INSTANCE_ID","QUESTION_LANGUE","EVALUATION_Q1_LIBELLE","EVALUATION_Q1_STR","EVALUATION_Q1","EVALUATION_Q2_LIBELLE","EVALUATION_Q2_STR","EVALUATION_Q2","EVALUATION_Q3_LIBELLE","EVALUATION_Q3_STR","EVALUATION_Q3","EVALUATION_Q4_LIBELLE","EVALUATION_Q4_STR","EVALUATION_Q4","EVALUATION_GLOBAL_LIBELLE","EVALUATION_GLOBAL_STR","EVALUATION_GLOBAL","EVALUATION_COMMENTAIRE_LIBELLE","EVALUATION_COMMENTAIRE_STR","EVALUATION_COMMENTAIRE") AS 
select "FORM_INSTANCE_ID","QUESTION_LANGUE","EVALUATION_Q1_LIBELLE","EVALUATION_Q1_STR","EVALUATION_Q1","EVALUATION_Q2_LIBELLE","EVALUATION_Q2_STR","EVALUATION_Q2","EVALUATION_Q3_LIBELLE","EVALUATION_Q3_STR","EVALUATION_Q3","EVALUATION_Q4_LIBELLE","EVALUATION_Q4_STR","EVALUATION_Q4","EVALUATION_GLOBAL_LIBELLE","EVALUATION_GLOBAL_STR","EVALUATION_GLOBAL","EVALUATION_COMMENTAIRE_LIBELLE","EVALUATION_COMMENTAIRE_STR","EVALUATION_COMMENTAIRE"
  from (
select FORM_INSTANCE_ID
     , QUESTION_LANGUE
     , QUESTION_LIBELLE
     , QUESTION_TYPE || QUESTION_INDEX as QUESTION_UNIQUE
     , REPONSE_CHAINE
     , REPONSE_CHOIX
  from V_V5_KRHEF_FORM_REPONSE_CHAUD
 where QUESTION_MODELE  = 1
   and FORM_INSTANCE_ID is not null
   and QUESTION_TYPE    in (
       'AraigneeEvaluation'
     , 'TextArea'
     , 'NotationSmiley'
   )
) pivot (
    max(QUESTION_LIBELLE) as LIBELLE
  , max(REPONSE_CHAINE) as STR
  , max(REPONSE_CHOIX)
  for QUESTION_UNIQUE in (
      'AraigneeEvaluation1' as EVALUATION_Q1
    , 'AraigneeEvaluation2' as EVALUATION_Q2
    , 'AraigneeEvaluation3' as EVALUATION_Q3
    , 'AraigneeEvaluation4' as EVALUATION_Q4
    , 'NotationSmiley0'     as EVALUATION_GLOBAL
    , 'TextArea0'           as EVALUATION_COMMENTAIRE
  )
)

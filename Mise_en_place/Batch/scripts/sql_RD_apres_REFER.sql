DELETE FROM NIV1 WHERE CODTS=1;
INSERT INTO NIV1 SELECT * FROM TMP_NIV1;
DELETE FROM NIV2 WHERE CODTS=1;
INSERT INTO NIV2 SELECT DISTINCT CODTS, CODNIV1, CODNIV2, LIBNIV2, DATE_OUV, DATE_FERM, EST_PREV FROM TMP_NIV2;
TRUNCATE TABLE STD_ADRSTR;
INSERT INTO STD_ADRSTR SELECT * FROM TMP_ADRSTR_ETB;
INSERT INTO STD_ADRSTR SELECT * FROM TMP_ADRSTR_STE;
DELETE FROM STD_TABRAC WHERE CODRUB IN (SELECT CODRUB FROM STD_FRUBRIQ WHERE TRAIT='N');
DELETE FROM STD_FRUBRIQ WHERE TRAIT='N';
TRUNCATE TABLE QUID_RUB;
INSERT INTO QUID_RUB SELECT STD_FRUBRIQ.CODRUB,STD_FRUBRIQ.LIBTOT, STD_FRUBRIQ.NUSEQU,STD_FRUBRIQ.FAMILL FROM STD_FRUBRIQ;
DELETE FROM STD_TABRAC WHERE CODRUB IN (SELECT CODRUB FROM STD_FRUBRIQ WHERE FAMILL='G');
DELETE FROM STD_IMPUTATION;
INSERT INTO STD_IMPUTATION SELECT CODE_IMPUT,LIBELLE_LANGUE_1 FROM GA_TABIMP WHERE CODE_IMPUT IS NOT NULL;
TRUNCATE TABLE STD_CONTRAT;
INSERT INTO STD_CONTRAT SELECT CODE_NATURCNT, 'fr_fr', LIBELLE_LONG, 0 FROM GA_NATURCNT WHERE UTILISE = 'O';
TRUNCATE TABLE STD_TYPCONTRAT;
INSERT INTO STD_TYPCONTRAT SELECT CODE_TYPE, LIBELLE, 1 FROM GA_TYPCNT;
TRUNCATE TABLE HRGP_FAMILLEMETIER;
INSERT INTO HRGP_FAMILLEMETIER (CODEFAM, LIBELLE) SELECT FILIERE, LIBELLE FROM GA_FILIERE WHERE FILIERE IS NOT NULL AND REGROUPEMENT_METIER IS NULL AND METIER IS NULL AND QUALIFICATION IS NULL;
TRUNCATE TABLE HRGP_METIER;
INSERT INTO HRGP_METIER (CODEFAM, CODEMET, LIBELLE) SELECT FILIERE, REGROUPEMENT_METIER, LIBELLE FROM GA_FILIERE WHERE FILIERE IS NOT NULL AND REGROUPEMENT_METIER IS NOT NULL AND METIER IS NULL AND QUALIFICATION IS NULL;
TRUNCATE TABLE HRGP_EMPLOIT;
INSERT INTO HRGP_EMPLOIT (CODEFAM, CODEMET, CODEEMPT, LIBELLE) SELECT FILIERE, REGROUPEMENT_METIER, METIER, LIBELLE FROM GA_FILIERE WHERE FILIERE IS NOT NULL AND REGROUPEMENT_METIER IS NOT NULL AND METIER IS NOT NULL AND QUALIFICATION IS NULL;
TRUNCATE TABLE HRGP_EMPLOIL;
INSERT INTO HRGP_EMPLOIL (CODEFAM, CODEMET, CODEEMPT, CODEEMPL, LIBELLE) SELECT FILIERE, REGROUPEMENT_METIER, METIER, QUALIFICATION, LIBELLE FROM GA_FILIERE WHERE FILIERE IS NOT NULL AND REGROUPEMENT_METIER IS NOT NULL AND METIER IS NOT NULL AND QUALIFICATION IS NOT NULL;
TRUNCATE TABLE HRGP_POSTE;
TRUNCATE TABLE EMP_FAMMETIER;
INSERT INTO EMP_FAMMETIER (CODFMET,LIBFMET) SELECT CODEFAM, LIBELLE FROM HRGP_FAMILLEMETIER;
TRUNCATE TABLE EMP_METIER;
INSERT INTO EMP_METIER (CODFMET,CODMETIER,LIBMETIER) SELECT CODEFAM, CODEMET, LIBELLE FROM HRGP_METIER;
TRUNCATE TABLE EMP_EMPLOI;
INSERT INTO EMP_EMPLOI (CODFMET,CODMETIER,CODEMPLOI,LIBEMPLOI) SELECT CODEFAM, CODEMET, CODEEMPT, LIBELLE FROM HRGP_EMPLOIT;
TRUNCATE TABLE POS_FAMMETIER;
INSERT INTO POS_FAMMETIER (CODFMET,LIBFMET) SELECT CODEFAM, LIBELLE FROM HRGP_FAMILLEMETIER;
TRUNCATE TABLE POS_METIER;
INSERT INTO POS_METIER (CODFMET,CODMETIER,LIBMETIER) SELECT CODEFAM, CODEMET, LIBELLE FROM HRGP_METIER;
TRUNCATE TABLE POS_EMPLOI;
INSERT INTO POS_EMPLOI (CODFMET,CODMETIER,CODEMPLOI,LIBEMPLOI) SELECT CODEFAM, CODEMET, CODEEMPT, LIBELLE FROM HRGP_EMPLOIT;
TRUNCATE TABLE POS_POSTE;
DELETE FROM STD_TSTABDGR; 
INSERT INTO STD_TSTABDGR SELECT CODE_GRILLE, NVL(NUMERO_DE_SEMAINE,' '), LIBELLE FROM GA_TSTABDGD WHERE DT_DEBUT_VALIDITE_SAMJ_INV=(SELECT MAX(DT_DEBUT_VALIDITE_SAMJ_INV) FROM GA_TSTABDGD T WHERE T.CODE_GRILLE=GA_TSTABDGD.CODE_GRILLE);
DELETE FROM TMP_GAPLIB_01 WHERE NOT TMP='LUT' OR TMP IS NULL;
DELETE GAP_LIBELLES WHERE (CODLANG, CODGROUP1, CODGROUP2) IN (SELECT DISTINCT CODLANG, CODGROUP1, CODGROUP2 FROM TMP_BATCH_GAP_LIBELLES);
INSERT INTO GAP_LIBELLES SELECT CODLANG, CODGROUP1, CODGROUP2, COD1, COD2, MIN(AFF_ORDER), MIN(LIB1), MIN(LIB2), MIN(LIB3), MIN(LIB4) FROM (SELECT DISTINCT * FROM TMP_BATCH_GAP_LIBELLES) GROUP BY CODLANG, CODGROUP1, CODGROUP2, COD1, COD2;
DELETE FROM GTA_PAR_TABFER where TAUX = '1'
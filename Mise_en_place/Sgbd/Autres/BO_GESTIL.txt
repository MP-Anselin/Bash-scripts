##
TAG_CHARSET=@€éèç
##
CREATE_TGE_GESTIL_NAT_ETL
=SQL IFNOTEXIST=TGE_GESTIL_NAT_ETL=
CREATE TABLE TGE_GESTIL_NAT_ETL ( NUMPAC VARCHAR2(6) ,NAT VARCHAR2(8) ,ACTIF VARCHAR2(1) DEFAULT 'O' ,CONSTRAINT CK_TGE_GESTIL_NAT_ETL1 CHECK (ACTIF IN ('O', 'N')) ,CONSTRAINT PK_TGE_GESTIL_NAT_ETL PRIMARY KEY (NUMPAC,NAT) )
##
CREATE_TGE_GESTIL_CPT_PER_ETL
=SQL IFNOTEXIST=TGE_GESTIL_CPT_PER_ETL=
CREATE TABLE TGE_GESTIL_CPT_PER_ETL ( NUMPAC VARCHAR2(6) ,CPT VARCHAR2(6) ,PER VARCHAR2(6) , DIVISEUR_VAL_VARJ NUMBER(11,0) DEFAULT 1 , UNITE VARCHAR2(20) DEFAULT 'Quantité' ,ACTIF VARCHAR2(1) DEFAULT 'O' ,CONSTRAINT CK_TGE_GESTIL_CPT_PER_ETL1 CHECK (DIVISEUR_VAL_VARJ != 0) ,CONSTRAINT CK_TGE_GESTIL_CPT_PER_ETL2 CHECK (UNITE IN ('Quantité', 'Jours', 'Heures')) ,CONSTRAINT CK_TGE_GESTIL_CPT_PER_ETL3 CHECK (ACTIF IN ('O', 'N')) ,CONSTRAINT PK_TGE_GESTIL_CPT_PER_ETL PRIMARY KEY (NUMPAC, CPT, PER) )
##
CREATE_TGE_GESTIL_FAM_HOR
=SQL IFNOTEXIST=TGE_GESTIL_FAM_HOR=
CREATE TABLE TGE_GESTIL_FAM_HOR ( NUMPAC VARCHAR2(6) , FAM_NOM VARCHAR2(3) , FAM_LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_FAM_HOR PRIMARY KEY (NUMPAC, FAM_NOM) )
##
CREATE_TGE_GESTIL_HOR
=SQL IFNOTEXIST=TGE_GESTIL_HOR=
CREATE TABLE TGE_GESTIL_HOR ( NUMPAC VARCHAR2(6) , ID NUMBER(11,0) , NOM1 VARCHAR2(6) , LIB VARCHAR2(30) , FAM VARCHAR2(3) , FAM_LIB VARCHAR2(30) , TYP VARCHAR2(1) ,CONSTRAINT PK_TGE_GESTIL_HOR PRIMARY KEY (NUMPAC, ID) ,CONSTRAINT CK_TGE_GESTIL_HOR1 CHECK (NOM1 IS NOT NULL))
##
CREATE_TGE_GESTIL_CYCHOR
=SQL IFNOTEXIST=TGE_GESTIL_CYCHOR=
CREATE TABLE TGE_GESTIL_CYCHOR ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(8) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_CYCHOR PRIMARY KEY (NUMPAC, NOM) )
##
CREATE_TGE_GESTIL_LIE
=SQL IFNOTEXIST=TGE_GESTIL_LIE=
CREATE TABLE TGE_GESTIL_LIE ( NUMPAC VARCHAR2(6) , ID NUMBER(11,0) , NOM1 VARCHAR2(6) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_LIE PRIMARY KEY (NUMPAC, ID) ,CONSTRAINT CK_TGE_GESTIL_LIE1 CHECK (NOM1 IS NOT NULL))
##
CREATE_TGE_GESTIL_FAM_NAT
=SQL IFNOTEXIST=TGE_GESTIL_FAM_NAT=
CREATE TABLE TGE_GESTIL_FAM_NAT ( NUMPAC VARCHAR2(6) , FAM_NOM VARCHAR2(10) , FAM_LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_FAM_NAT PRIMARY KEY (NUMPAC, FAM_NOM) )
##
CREATE_TGE_GESTIL_NAT
=SQL IFNOTEXIST=TGE_GESTIL_NAT=
CREATE TABLE TGE_GESTIL_NAT ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , LIB VARCHAR2(30) , CDE_CORR VARCHAR2(6) , FAM_NAT VARCHAR2(10) , FAM_LIB VARCHAR2(30),CONSTRAINT PK_TGE_GESTIL_NAT PRIMARY KEY (NUMPAC, NOM) )
##
CREATE_TGE_GESTIL_LISNATD
=SQL IFNOTEXIST=TGE_GESTIL_LISNATD=
CREATE TABLE TGE_GESTIL_LISNATD ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , LIB VARCHAR2(30) , NAT VARCHAR2(6) ,CONSTRAINT PK_TGE_GESTIL_LISNATD PRIMARY KEY (NUMPAC, NOM , NAT) )
##
CREATE_TGE_GESTIL_CODD_ANOMALIE
=SQL IFNOTEXIST=TGE_GESTIL_CODD_ANOMALIE=
CREATE TABLE TGE_GESTIL_CODD_ANOMALIE ( NUMPAC VARCHAR2(6) , CLE1 VARCHAR2(20) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_CODD_ANOMALIE PRIMARY KEY (NUMPAC, CLE1) )
##
CREATE_TGE_GESTIL_CALENDAR
=SQL IFNOTEXIST=TGE_GESTIL_CALENDAR=
CREATE TABLE TGE_GESTIL_CALENDAR ( DAT_JOU DATE , JOUR VARCHAR2(2) , MOIS VARCHAR2(2) , ANNEE VARCHAR2(4) , MOISNB NUMBER(2) , JOURNB NUMBER(2) , ANNEENB NUMBER(4) , MOISANNEE VARCHAR2(9) , NUMJOURSEM NUMBER(1) , JOUR_SEM VARCHAR2(8) , CALENDAIRE NUMBER(1) , OUVRABLE NUMBER(1) , OUVRE NUMBER(1) ,CONSTRAINT PK_TGE_GESTIL_CALENDAR PRIMARY KEY (DAT_JOU) )
INSERT INTO TGE_GESTIL_CALENDAR ( DAT_JOU, JOUR, MOIS, ANNEE, JOURNB, MOISNB, ANNEENB, MOISANNEE, NUMJOURSEM, JOUR_SEM, CALENDAIRE, OUVRABLE, OUVRE ) SELECT DAT_JOU, TO_CHAR(DAT_JOU, 'DD') AS JOUR, TO_CHAR(DAT_JOU, 'MM') AS MOIS, TO_CHAR(DAT_JOU, 'YYYY') AS ANNEE, TO_NUMBER(TO_CHAR(DAT_JOU, 'DD')) AS JOURNB, TO_NUMBER(TO_CHAR(DAT_JOU, 'MM')) AS MOISNB, TO_NUMBER(TO_CHAR(DAT_JOU, 'YYYY')) AS ANNEENB, TO_CHAR(DAT_JOU, 'Month') AS MOISANNEE, TO_NUMBER(TO_CHAR(DAT_JOU, 'D')) AS NUMJOURSEM, DECODE(TO_CHAR(DAT_JOU, 'D'), 1, 'Lundi', 2, 'Mardi', 3, 'Mercredi', 4, 'Jeudi', 5, 'Vendredi', 6, 'Samedi', 7, 'Dimanche') AS JOUR_SEM, CASE WHEN TO_CHAR(DAT_JOU, 'D') IN (1,2,3,4,5,6,7) THEN 1 END AS CALENDAIRE, CASE WHEN TO_CHAR(DAT_JOU, 'D') IN (1,2,3,4,5,6) THEN 1 ELSE 0 END AS OUVRABLE, CASE WHEN TO_CHAR(DAT_JOU, 'D') IN (1,2,3,4,5) THEN 1 ELSE 0 END AS OUVRE FROM ( SELECT TRUNC(TO_DATE('31/12/1999', 'DD/MM/YYYY')) + ROWNUM AS DAT_JOU FROM DUAL CONNECT BY ROWNUM < 36526 )
##
CREATE_TGE_GESTIL_POS
=SQL IFNOTEXIST=TGE_GESTIL_POS=
CREATE TABLE TGE_GESTIL_POS ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(10) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_POS PRIMARY KEY (NUMPAC, NOM) )
##
CREATE_TGE_GESTIL_EQU
=SQL IFNOTEXIST=TGE_GESTIL_EQU=
CREATE TABLE TGE_GESTIL_EQU ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_EQU PRIMARY KEY (NUMPAC, NOM) )
##
CREATE_TGE_GESTIL_PER
=SQL IFNOTEXIST=TGE_GESTIL_PER=
CREATE TABLE TGE_GESTIL_PER ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_PER PRIMARY KEY (NUMPAC, NOM) )
##
CREATE_TGE_GESTIL_CPT
=SQL IFNOTEXIST=TGE_GESTIL_CPT=
CREATE TABLE TGE_GESTIL_CPT ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , PER VARCHAR2(6) , LIB VARCHAR2(30) ,CONSTRAINT PK_TGE_GESTIL_CPT PRIMARY KEY (NUMPAC, NOM, PER) )
##
CREATE_TGE_GESTIL_PERDAT
=SQL IFNOTEXIST=TGE_GESTIL_PERDAT=
CREATE TABLE TGE_GESTIL_PERDAT ( NUMPAC VARCHAR2(6) , NOM VARCHAR2(6) , RANG NUMBER(6,0) , DAT_DEB DATE , DAT_FIN DATE ,CONSTRAINT PK_TGE_GESTIL_PERDAT PRIMARY KEY (NUMPAC, NOM , RANG) )
##
TGE_GESTIL_MATJOU
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATJOU' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATJOU';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATJOU';
	END IF;
  
	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATJOU (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,DAT_JOU DATE
		,ENR VARCHAR2(1)
		,HOR NUMBER(11,0) DEFAULT 0
		,HOR_TYP VARCHAR2(1)
		,HRS_DEBB VARCHAR2(6)
		,HRJ_DEBB NUMBER(6,0)
		,HRS_FINB VARCHAR2(6)
		,HRJ_FINB NUMBER(6,0)
		,STATUT VARCHAR2(1) DEFAULT ''O''
		,ANO1 VARCHAR2(2) DEFAULT ''##''
		,ANO2 VARCHAR2(2) DEFAULT ''##''
		,ANO3 VARCHAR2(2) DEFAULT ''##''
		,HOR_CAL NUMBER(11,0)
		,PROV_MP VARCHAR2(1)
		,PROV_PTR VARCHAR2(1)
		,HOR_MAT_P NUMBER(11,0) DEFAULT 0
		,HOR_MAT_T NUMBER(11,0) DEFAULT 0
		,HOR_MAT_R NUMBER(11,0) DEFAULT 0
		,HOR_POE_P NUMBER(11,0) DEFAULT 0
		,HOR_POE_T NUMBER(11,0) DEFAULT 0
		,CYC_EFF VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_P VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_T VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_R VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_MAT_P VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_MAT_T VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_MAT_R VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_POE_P VARCHAR2(8) DEFAULT ''CYCNRS''
		,CYC_POE_T VARCHAR2(8) DEFAULT ''CYCNRS''
		,LIEU_P NUMBER(11,0) DEFAULT 0
		,LIEU1 NUMBER(11,0) DEFAULT 0
		,LIEU2 NUMBER(11,0) DEFAULT 0
		,LIEU3 NUMBER(11,0) DEFAULT 0
		,LIEU4 NUMBER(11,0) DEFAULT 0
		,LIEU5 NUMBER(11,0) DEFAULT 0
		,NAT_THE VARCHAR2(6) DEFAULT ''CYCNRS''
		,TPS_THE VARCHAR2(8)
		,TPM_THE NUMBER(11,0)
		,TPHC_THE NUMBER(11,3)
		,OEUVRE NUMBER(1)
	) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
		
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATJOU ADD (
		CONSTRAINT CK_TGE_GESTIL_MATJOU1 CHECK (HOR IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU2 CHECK (STATUT IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU3 CHECK (ANO1 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU4 CHECK (ANO2 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU5 CHECK (ANO3 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU6 CHECK (HOR_MAT_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU7 CHECK (HOR_MAT_T IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU8 CHECK (HOR_MAT_R IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU9 CHECK (HOR_POE_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU10 CHECK (HOR_POE_T IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU11 CHECK (CYC_EFF IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU12 CHECK (CYC_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU13 CHECK (CYC_T IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU14 CHECK (CYC_R IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU15 CHECK (CYC_MAT_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU16 CHECK (CYC_MAT_T IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU17 CHECK (CYC_MAT_R IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU18 CHECK (CYC_POE_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU19 CHECK (CYC_POE_T IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU020 CHECK (LIEU_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU21 CHECK (LIEU1 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU22 CHECK (LIEU2 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU23 CHECK (LIEU3 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU24 CHECK (LIEU4 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU25 CHECK (LIEU5 IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOU26 CHECK (NAT_THE IS NOT NULL) )';
END;
##
IDX_TGE_GESTIL_MATJOU1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATJOU1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATJOU1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATJOU1 ON TGE_GESTIL_MATJOU (NUMPAC, MAT, DAT_JOU) LOCAL NOLOGGING';
END;
##
IDX_TGE_GESTIL_MATJOU2
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATJOU2';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATJOU2';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE INDEX IDX_TGE_GESTIL_MATJOU2 ON TGE_GESTIL_MATJOU (NUMPAC, DAT_JOU) LOCAL NOLOGGING';
END;
##
TGE_GESTIL_MATJOUD
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATJOUD' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATJOUD';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATJOUD';
	END IF;

	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATJOUD (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,DAT_JOU DATE
		,ENR VARCHAR2(1)
		,RANG NUMBER(6)
		,FNATANO VARCHAR2(1)
		,NAT_TYP VARCHAR2(1)
		,NAT VARCHAR2(6) DEFAULT ''NATNRS''
		,NAT_S VARCHAR2(6) DEFAULT ''NATNRS''
		,TPS_NAT VARCHAR2(8)
		,TPM_NAT NUMBER(11,0)
		,TPHC_NAT NUMBER(11,3)
		,HRS_DEB VARCHAR2(6)
		,HRJ_DEB NUMBER(6,0)
		,HRS_FIN VARCHAR2(6)
		,HRJ_FIN NUMBER(6,0)
		,CODPLJ VARCHAR2(1)
		,PROV_LIEU VARCHAR2(1)
		,LIEU NUMBER(11,0) DEFAULT 0
		,POS VARCHAR2(10) DEFAULT ''POSNRS''
		,EQU VARCHAR2(6) DEFAULT ''EQUNRS''
		,LIEU_P NUMBER(11,0) DEFAULT 0
		,POS_P VARCHAR2(10) DEFAULT ''POSNRS''
		,EQU_P VARCHAR2(6) DEFAULT ''EQUNRS''
		,LIEU_T NUMBER(11,0) DEFAULT 0
		,POS_T VARCHAR2(10) DEFAULT ''POSNRS''
		,EQU_T VARCHAR2(6) DEFAULT ''EQUNRS''
		,LIEU_R NUMBER(11,0) DEFAULT 0
		,POS_R VARCHAR2(10) DEFAULT ''POSNRS''
		,EQU_R VARCHAR2(6) DEFAULT ''EQUNRS''
		,QTE1 NUMBER(11,0)
		,QTE2 NUMBER(11,0)
		,PROV_EVE VARCHAR2(1)
		,DAT_DEB_EVE DATE
		,DAT_FIN_EVE DATE
		,Z2_VSTATE VARCHAR2(1)
	) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
	
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATJOUD ADD (
		CONSTRAINT CK_TGE_GESTIL_MATJOUD1 CHECK (NAT IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD2 CHECK (NAT_S IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD3 CHECK (LIEU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD4 CHECK (POS IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD5 CHECK (EQU IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD6 CHECK (LIEU_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD7 CHECK (POS_P IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD8 CHECK (EQU_P IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD9 CHECK (LIEU_T IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD10 CHECK (POS_T IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD11 CHECK (EQU_T IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD12 CHECK (LIEU_R IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD13 CHECK (POS_R IS NOT NULL)	
		,CONSTRAINT CK_TGE_GESTIL_MATJOUD14 CHECK (EQU_R IS NOT NULL)
	)';
END;
##
IDX_TGE_GESTIL_MATJOUD1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATJOUD1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATJOUD1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATJOUD1 ON TGE_GESTIL_MATJOUD (NUMPAC, MAT, DAT_JOU, RANG) LOCAL NOLOGGING';
END;
##
IDX_TGE_GESTIL_MATJOUD2
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATJOUD2';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATJOUD2';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE INDEX IDX_TGE_GESTIL_MATJOUD2 ON TGE_GESTIL_MATJOUD (NUMPAC, DAT_JOU) LOCAL NOLOGGING';
END;
##
TGE_GESTIL_MATCPT
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATCPT' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATCPT';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATCPT';
	END IF;
  
	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATCPT (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,DAT_CPT DATE
		,DAT_FIN_CPT DATE
		,CPT VARCHAR2(6)
		,PER VARCHAR2(6)
		,FFINPER VARCHAR2(1)
		,ANNEE NUMBER(6,0)
		,NUMPER NUMBER(11,0)
		,VARJ NUMBER(11,3)
		,VAL NUMBER(11,3)
		,UNITE VARCHAR2(20) DEFAULT ''Quantité''
		,PERDAT_RANG NUMBER(6)
	) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
	
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATCPT ADD (
		CONSTRAINT CK_TGE_GESTIL_MATCPT_CPT1 CHECK (DAT_FIN_CPT IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATCPT_CPT2 CHECK (PERDAT_RANG IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATCPT_CPT3 CHECK (UNITE IN (''Quantité'', ''Jours'', ''Heures''))
	)';
END;
##
IDX_TGE_GESTIL_MATCPT1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATCPT1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATCPT1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATCPT1 ON TGE_GESTIL_MATCPT (NUMPAC, MAT, DAT_CPT, CPT, PER) LOCAL NOLOGGING';
END;
##
IDX_TGE_GESTIL_MATCPT2
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATCPT2';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATCPT2';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE INDEX IDX_TGE_GESTIL_MATCPT2 ON TGE_GESTIL_MATCPT (NUMPAC, DAT_CPT) LOCAL NOLOGGING';
END;
##
TGE_GESTIL_MATHOR
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATHOR' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATHOR';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATHOR';
	END IF;
	
	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATHOR (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,ENR VARCHAR2(1)
		,DAT_AFF DATE
		,DAT_FIN DATE
		,FORM VARCHAR2(1)
		,CYCHOR VARCHAR2(8) DEFAULT ''CYCNRS'' 
		,HOR NUMBER(11,0) DEFAULT 0
		,P_DAT_AFF DATE
		,P_DAT_FIN DATE
		,P_CYCHOR VARCHAR2(8)
		,P_HOR NUMBER(11,0)
		,T_DAT_AFF DATE
		,T_DAT_FIN DATE
		,T_CYCHOR VARCHAR2(8)
		,T_HOR NUMBER(11,0)
		,R_DAT_AFF DATE
		,R_DAT_FIN DATE
		,R_CYCHOR VARCHAR2(8)
		,R_HOR NUMBER(11,0)
	) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
	
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATHOR ADD (
		CONSTRAINT CK_TGE_GESTIL_MATHOR1 CHECK (ENR IN (''P'',''T'',''R''))
		,CONSTRAINT CK_TGE_GESTIL_MATHOR2 CHECK (DAT_FIN IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATHOR3 CHECK (FORM IN (''C'', ''H''))
		,CONSTRAINT CK_TGE_GESTIL_MATHOR4 CHECK (CYCHOR IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATHOR5 CHECK (HOR IS NOT NULL)
	)';
END;
##
IDX_TGE_GESTIL_MATHOR1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATHOR';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATHOR';
	END IF ;
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATHOR1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATHOR1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATHOR1 ON TGE_GESTIL_MATHOR (NUMPAC, MAT, DAT_AFF) LOCAL NOLOGGING';
END;
##
TGE_GESTIL_MATLIE
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATLIE' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATLIE';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATLIE';
	END IF;
	
	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATLIE (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,DAT_AFF DATE
		,DAT_FIN DATE
		,ENR VARCHAR2(1)
		,FORM VARCHAR2(1)
		,LIEU NUMBER(11) DEFAULT 0
		,POS VARCHAR2(10) DEFAULT ''POSNRS''
		,EQU VARCHAR2(6) DEFAULT ''EQUNRS''
		,P_DAT_AFF DATE
		,P_DAT_FIN DATE
		,P_LIEU NUMBER(11) DEFAULT 0
		,P_POS VARCHAR2(10) DEFAULT ''POSNRS''
		,P_EQU VARCHAR2(6) DEFAULT ''EQUNRS''
		,P_FHORPOE VARCHAR2(1)
		,P_HRS_DEB VARCHAR2(6)
		,P_HRJ_DEB NUMBER(6)
		,P_HRS_FIN VARCHAR2(6)
		,P_HRJ_FIN NUMBER(6)
		,P_POURC NUMBER(6)	
		,T_DAT_AFF DATE
		,T_DAT_FIN DATE
		,T_LIEU NUMBER(11) DEFAULT 0
		,T_POS VARCHAR2(10) DEFAULT ''POSNRS''
		,T_EQU VARCHAR2(6) DEFAULT ''EQUNRS''
		,T_FHORPOE VARCHAR2(1)
		,T_HRS_DEB VARCHAR2(6)
		,T_HRJ_DEB NUMBER(6)
		,T_HRS_FIN VARCHAR2(6)
		,T_HRJ_FIN NUMBER(6)
		,T_POURC NUMBER(6)
		,R_DAT_AFF DATE
		,R_DAT_FIN DATE
		,R_LIEU NUMBER(11) DEFAULT 0
		,R_POS VARCHAR2(10) DEFAULT ''POSNRS''
		,R_EQU VARCHAR2(6) DEFAULT ''EQUNRS''
		,R_FHORPOE VARCHAR2(1)
		,R_HRS_DEB VARCHAR2(6)
		,R_HRJ_DEB NUMBER(6)
		,R_HRS_FIN VARCHAR2(6)
		,R_HRJ_FIN NUMBER(6)
		,R_POURC NUMBER(6)
		) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
	
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATLIE ADD (
		CONSTRAINT CK_TGE_GESTIL_MATLIE1 CHECK (DAT_FIN IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE2 CHECK ( ENR IN (''P'',''T'',''R'') )
		,CONSTRAINT CK_TGE_GESTIL_MATLIE3 CHECK ( FORM IN (''L'',''P'',''E'') )
		,CONSTRAINT CK_TGE_GESTIL_MATLIE4 CHECK (LIEU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE5 CHECK (POS IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE6 CHECK (EQU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE7 CHECK (P_LIEU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE8 CHECK (P_POS IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE9 CHECK (P_EQU IS NOT NULL)		
		,CONSTRAINT CK_TGE_GESTIL_MATLIE10 CHECK (T_LIEU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE11 CHECK (T_POS IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE12 CHECK (T_EQU IS NOT NULL)			
		,CONSTRAINT CK_TGE_GESTIL_MATLIE13 CHECK (R_LIEU IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE14 CHECK (R_POS IS NOT NULL)
		,CONSTRAINT CK_TGE_GESTIL_MATLIE15 CHECK (R_EQU IS NOT NULL)	
	)';
END;
##
IDX_TGE_GESTIL_MATLIE1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATLIE';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATLIE';
	END IF ;
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATLIE1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATLIE1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATLIE1 ON TGE_GESTIL_MATLIE (NUMPAC, MAT, DAT_AFF) LOCAL NOLOGGING';
END;
##
TGE_GESTIL_MATBAD
=SQL=
DECLARE
	TABLE_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TAB_PARTITIONS WHERE TABLE_NAME = 'TGE_GESTIL_MATBAD' AND PARTITION_NAME = 'NUMPAC_DEFAULT';
	IF TABLE_EXIST = 1 THEN
		RETURN;
	END IF;
  
	SELECT COUNT(*) INTO TABLE_EXIST FROM USER_TABLES WHERE TABLE_NAME = 'TGE_GESTIL_MATBAD';
	IF TABLE_EXIST = 1 THEN
		EXECUTE IMMEDIATE 'DROP TABLE TGE_GESTIL_MATBAD';
	END IF;
	
	EXECUTE IMMEDIATE 'CREATE TABLE TGE_GESTIL_MATBAD (
		NUMPAC VARCHAR2(6)
		,MAT VARCHAR2(8)
		,ENR VARCHAR2(1)
		,DAT_AFF DATE
		,DAT_FIN DATE
		,BADGE VARCHAR2(8)
		,LIB VARCHAR2(30)
		,CAT VARCHAR2(2)
		,AFFCPT VARCHAR2(6)
		,REGA VARCHAR2(2)
		,REGT VARCHAR2(2)
		,REGS VARCHAR2(2)
		,F_TPS_REEL VARCHAR2(1) DEFAULT ''N''
		,F_TRAIT_POE VARCHAR2(1) DEFAULT ''N''
		) PARTITION BY LIST (NUMPAC) ( PARTITION NUMPAC_DEFAULT VALUES (DEFAULT) ) NOLOGGING';
	
	EXECUTE IMMEDIATE 'ALTER TABLE TGE_GESTIL_MATBAD ADD (
		CONSTRAINT CK_TGE_GESTIL_MATBAD1 CHECK (F_TPS_REEL IN (''O'',''N''))
		,CONSTRAINT CK_TGE_GESTIL_MATBAD2 CHECK (F_TRAIT_POE IN (''O'',''N''))	
	)';
END;
##
TGE_GESTIL_MATBAD1
=SQL=
DECLARE
IDX_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATBAD';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATBAD';
	END IF ;
	SELECT COUNT(*) INTO IDX_EXIST FROM USER_INDEXES WHERE INDEX_NAME = 'IDX_TGE_GESTIL_MATBAD1';
	IF IDX_EXIST > 0 THEN
		EXECUTE IMMEDIATE 'DROP INDEX IDX_TGE_GESTIL_MATBAD1';
	END IF ;
	EXECUTE IMMEDIATE 'CREATE UNIQUE INDEX IDX_TGE_GESTIL_MATBAD1 ON TGE_GESTIL_MATBAD (NUMPAC, MAT, DAT_AFF) LOCAL NOLOGGING';
END;
##
CREATE_TGE_GESTIL_SQL
=SQL IFEXIST=TGE_GESTIL_SQL=
DROP TABLE TGE_GESTIL_SQL
##
CREATE_TGE_GESTIL_SQL
=SQL=
CREATE TABLE TGE_GESTIL_SQL ( TABLENAME VARCHAR2(30) , TABLEORDER NUMBER(3)  , TABLEREF NUMBER(1) , TABLESUFFIX VARCHAR2(3) , HISBISTER NUMBER(1) , ADPURGE VARCHAR2(15),STSAVE VARCHAR2(250) ,TABLESELECT CLOB ,CONSTRAINT PK_TGE_GESTIL_SQL PRIMARY KEY (TABLENAME,TABLEORDER) ,CONSTRAINT CK_TGE_GESTIL_SQL1 CHECK (TABLEREF IN (0,1)),CONSTRAINT CK_TGE_GESTIL_SQL2 CHECK (TABLESUFFIX IN ('HIS','BIS','TER')) ,CONSTRAINT CK_HISBISTER1 CHECK (HISBISTER IN (0,1)) )
##
TGE_GESTIL_SQL
==
DELETE FROM TGE_GESTIL_SQL
'TGE_GESTIL_NAT','10','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_NAT.NOM),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_NAT.LIB),'' ''),30,'' '') || RPAD(NVL(TRIM(AD_NAT.CDE_CORR),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_NAT.FAM_NAT),'' ''),10,'' '') || RPAD(NVL(TRIM(BO_FAM_NAT.FAM_LIB),'' ''),30,'' '')¿FROM AD_NAT¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1 ON ( T1.NAT = TRIM(AD_NAT.NOM) )¿LEFT JOIN BO_FAM_NAT ON (BO_FAM_NAT.FAM_NOM = TRIM(AD_NAT.FAM_NAT)) ¿WHERE AD_NAT.DOM = ''2'' AND T1.NUMPAC = ''$NUMPAC'' AND T1.ACTIF = ''O''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''NATNRS'',6,'' '') || RPAD(''Nature non renseignée'',30,'' '') || RPAD('''',6,'' '') || RPAD('''',10,'' '') || RPAD('''',30,'' '')¿FROM DUAL'
'TGE_GESTIL_LISNATD','20','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_LISNATD.NOM),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_LISNAT.LIB),'' ''),30,'' '') || RPAD(NVL(TRIM(AD_LISNATD.NAT),'' ''),6,'' '') ¿FROM AD_LISNATD¿JOIN AD_LISNAT ON (AD_LISNAT.DOM = AD_LISNATD.DOM AND AD_LISNAT.NOM = AD_LISNATD.NOM) ¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1 ON ( T1.NAT = TRIM(AD_LISNATD.NAT) )¿WHERE AD_LISNATD.DOM = ''2'' AND T1.NUMPAC = ''$NUMPAC'' AND T1.ACTIF = ''O'''
'TGE_GESTIL_FAM_HOR','20','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(FAM_NOM,'' ''),3,'' '') || RPAD(NVL(TRIM(FAM_LIB),'' ''),30,'' '') FROM BO_FAM_HOR'
'TGE_GESTIL_HOR','40','1',NULL,'0',NULL,NULL,'WITH HOR AS (SELECT ''$NUMPAC'' AS NUMPAC, ID , TRIM(NOM1) AS NOM1 , LIB , TRIM(FAM) AS FAM , TYP¿FROM AD_HOR T1¿WHERE DOM = ''2'' AND DAT_EFF = (SELECT MAX(DAT_EFF) FROM AD_HOR T2 WHERE T2.DOM = T1.DOM AND T2.ID = T1.ID GROUP BY T2.ID)¿)¿SELECT RPAD(NVL(NUMPAC,'' ''),6,'' '') || TO_CHAR(NVL(ID,0),''S00000000000'') || RPAD(NVL(NOM1,'' ''),6,'' '') || RPAD(NVL(LIB,'' ''),30,'' '') || RPAD(NVL(FAM,'' ''),3,'' '') || RPAD(NVL(BO_FAM_HOR.FAM_LIB,'' ''),30,'' '') || RPAD(NVL(TYP,'' ''),1,'' '')¿FROM HOR¿LEFT JOIN BO_FAM_HOR ON (HOR.FAM = TRIM(BO_FAM_HOR.FAM_NOM))¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || ''+00000000000'' || ''HORNRS'' || RPAD(''Horaire non renseigné'',30,'' '') || RPAD(NVL('''','' ''),3,'' '') || RPAD('''',30,'' '') || RPAD('''',1,'' '')¿FROM DUAL'
'TGE_GESTIL_CYCHOR','50','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(NOM),'' ''),8,'' '') || RPAD(NVL(LIB,'' ''),30,'' '') ¿FROM AD_CYCHOR T1¿WHERE DOM = ''2'' AND DAT_EFF = (SELECT MAX(DAT_EFF) FROM AD_CYCHOR T2 WHERE T2.DOM = T1.DOM AND T2.NOM = T1.NOM  GROUP BY T2.NOM)¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''CYCNRS'',8,'' '') || RPAD(''Cycle non renseigné'',30,'' '')¿FROM DUAL'
'TGE_GESTIL_LIE','60','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || TO_CHAR(NVL(ID,0),''S00000000000'') || RPAD(NVL(TRIM(NOM1),'' ''),6,'' '') || RPAD(NVL(TRIM(LIB),'' ''),30,'' '') ¿FROM AD_LIE¿WHERE DOM = ''2''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || ''+00000000000'' || RPAD(''LIENRS'',6,'' '') || RPAD(''Lieu non renseigné'',30,'' '')¿FROM DUAL'
'TGE_GESTIL_FAM_NAT','70','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(FAM_NOM,'' ''),10,'' '') || RPAD(NVL(FAM_LIB,'' ''),30,'' '') ¿FROM BO_FAM_NAT'
'TGE_GESTIL_CODD_ANOMALIE','80','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_CODD.CLE1),'' ''),20,'' '') || RPAD(NVL(AD_CODD.LIB,'' ''),30,'' '') ¿FROM AD_CODD¿WHERE AD_CODD.DOM = ''2'' AND AD_CODD.NOM = ''ANOMALIE''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''##'',20,'' '') || RPAD(''Journée sans anomalie'',30,'' '')¿FROM DUAL'
'TGE_GESTIL_POS','90','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_POS.NOM),'' ''),10,'' '') || RPAD(NVL(AD_POS.LIB,'' ''),30,'' '') ¿FROM AD_POS¿WHERE AD_POS.DOM = ''2''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''POSNRS'',10,'' '') || RPAD(''Poste non renseigné'',30,'' '') FROM DUAL'
'TGE_GESTIL_EQU','100','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_EQU.NOM),'' ''),6,'' '') || RPAD(NVL(AD_EQU.LIB,'' ''),30,'' '') ¿FROM AD_EQU¿WHERE AD_EQU.DOM = ''2''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''EQUNRS'',6,'' '') || RPAD(''Equipe non renseignée'',30,'' '') ¿FROM DUAL'
'TGE_GESTIL_PER','110','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_PER.NOM),'' ''),6,'' '') || RPAD(NVL(AD_PER.LIB,'' ''),30,'' '') ¿FROM AD_PER¿WHERE AD_PER.DOM = ''2''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''PERNRS'',6,'' '') || RPAD(''Période non renseignée'',30,'' '') ¿FROM DUAL'
'TGE_GESTIL_PERDAT','120','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(NOM),'' ''),6,'' '') || TO_CHAR(NVL(RANG,0),''S000000'') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_DEB), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '')¿FROM BO_PERDAT'
'TGE_GESTIL_CPT','130','1',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(TRIM(AD_CPT.NOM),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_CPT.PER),'' ''),6,'' '') ||RPAD(NVL(AD_CPT.LIB,'' ''),30,'' '') ¿FROM AD_CPT¿WHERE AD_CPT.DOM = ''2''¿UNION¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(''CPTNRS'',6,'' '') || RPAD(''PERNRS'',6,'' '') ||RPAD(''Compteur non renseigné'',30,'' '') ¿FROM DUAL'
'TGE_GESTIL_MATJOU','140','0',NULL,'1','AD_MATJOU','NUMPAC = ''$NUMPAC'' AND DAT_JOU < TO_DATE(''$DATE'',''YYYY/MM/DD'')','SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(HOR,0),''S00000000000'') || RPAD(NVL(HOR_TYP,'' ''),1,'' '') ¿ || RPAD(NVL(HRS_DEBB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_DEBB,0),''S000000'') || RPAD(NVL(HRS_FINB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_FINB,0),''S000000'') || RPAD(NVL(STATUT,'' ''),1,'' '')¿ || RPAD(NVL(TRIM(ANO1), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO2), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO3), ''##''),2,'' '') || TO_CHAR(NVL(HOR_CAL,0),''S00000000000'') || RPAD(NVL(PROV_MP,'' ''),1,'' '')¿ || RPAD(NVL(PROV_PTR,'' ''),1,'' '') || TO_CHAR(NVL(HOR_MAT_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_T,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_R,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_T,0),''S00000000000'')¿ || RPAD(NVL(TRIM(CYC_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_T), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_T), ''CYCNRS''),8,'' '')¿ || RPAD(NVL(TRIM(CYC_MAT_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_T), ''CYCNRS''),8,'' '') || TO_CHAR(NVL(LIEU_P,0),''S00000000000'')¿ || TO_CHAR(NVL(LIEU1,0),''S00000000000'') || TO_CHAR(NVL(LIEU2,0),''S00000000000'') || TO_CHAR(NVL(LIEU3,0),''S00000000000'') || TO_CHAR(NVL(LIEU4,0),''S00000000000'') || TO_CHAR(NVL(LIEU5,0),''S00000000000'')¿ || RPAD( NVL(TRIM(NAT_THE), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_THE,'' ''),8,'' '') || TO_CHAR(NVL(TPM_THE,0),''S00000000000'') || TO_CHAR(NVL(ROUND(TPM_THE/60, 3),0),''S00000000D000'') || CASE WHEN TPM_THE=0 THEN 0 ELSE 1 END¿FROM AD_MATJOU¿WHERE DOM = ''2'' AND SOC = ''HRV'''
'TGE_GESTIL_MATJOU','141','0','BIS','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(HOR,0),''S00000000000'') || RPAD(NVL(HOR_TYP,'' ''),1,'' '') ¿ || RPAD(NVL(HRS_DEBB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_DEBB,0),''S000000'') || RPAD(NVL(HRS_FINB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_FINB,0),''S000000'') || RPAD(NVL(STATUT,'' ''),1,'' '')¿ || RPAD(NVL(TRIM(ANO1), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO2), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO3), ''##''),2,'' '') || TO_CHAR(NVL(HOR_CAL,0),''S00000000000'') || RPAD(NVL(PROV_MP,'' ''),1,'' '')¿ || RPAD(NVL(PROV_PTR,'' ''),1,'' '') || TO_CHAR(NVL(HOR_MAT_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_T,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_R,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_T,0),''S00000000000'')¿ || RPAD(NVL(TRIM(CYC_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_T), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_T), ''CYCNRS''),8,'' '')¿ || RPAD(NVL(TRIM(CYC_MAT_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_T), ''CYCNRS''),8,'' '') || TO_CHAR(NVL(LIEU_P,0),''S00000000000'')¿ || TO_CHAR(NVL(LIEU1,0),''S00000000000'') || TO_CHAR(NVL(LIEU2,0),''S00000000000'') || TO_CHAR(NVL(LIEU3,0),''S00000000000'') || TO_CHAR(NVL(LIEU4,0),''S00000000000'') || TO_CHAR(NVL(LIEU5,0),''S00000000000'')¿ || RPAD( NVL(TRIM(NAT_THE), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_THE,'' ''),8,'' '') || TO_CHAR(NVL(TPM_THE,0),''S00000000000'') || TO_CHAR(NVL(ROUND(TPM_THE/60, 3),0),''S00000000D000'') || CASE WHEN TPM_THE=0 THEN 0 ELSE 1 END¿FROM AD_MATJOU_BIS¿WHERE DOM = ''2'' AND SOC = ''HRV'''
'TGE_GESTIL_MATJOU','142','0','HIS','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(HOR,0),''S00000000000'') || RPAD(NVL(HOR_TYP,'' ''),1,'' '') ¿ || RPAD(NVL(HRS_DEBB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_DEBB,0),''S000000'') || RPAD(NVL(HRS_FINB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_FINB,0),''S000000'') || RPAD(NVL(STATUT,'' ''),1,'' '')¿ || RPAD(NVL(TRIM(ANO1), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO2), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO3), ''##''),2,'' '') || TO_CHAR(NVL(HOR_CAL,0),''S00000000000'') || RPAD(NVL(PROV_MP,'' ''),1,'' '')¿ || RPAD(NVL(PROV_PTR,'' ''),1,'' '') || TO_CHAR(NVL(HOR_MAT_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_T,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_R,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_T,0),''S00000000000'')¿ || RPAD(NVL(TRIM(CYC_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_T), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_T), ''CYCNRS''),8,'' '')¿ || RPAD(NVL(TRIM(CYC_MAT_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_T), ''CYCNRS''),8,'' '') || TO_CHAR(NVL(LIEU_P,0),''S00000000000'')¿ || TO_CHAR(NVL(LIEU1,0),''S00000000000'') || TO_CHAR(NVL(LIEU2,0),''S00000000000'') || TO_CHAR(NVL(LIEU3,0),''S00000000000'') || TO_CHAR(NVL(LIEU4,0),''S00000000000'') || TO_CHAR(NVL(LIEU5,0),''S00000000000'')¿ || RPAD( NVL(TRIM(NAT_THE), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_THE,'' ''),8,'' '') || TO_CHAR(NVL(TPM_THE,0),''S00000000000'') || TO_CHAR(NVL(ROUND(TPM_THE/60, 3),0),''S00000000D000'') || CASE WHEN TPM_THE=0 THEN 0 ELSE 1 END¿FROM AD_MATJOU_HIS¿WHERE DOM = ''2'' AND SOC = ''HRV'''
'TGE_GESTIL_MATJOU','143','0','TER','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(HOR,0),''S00000000000'') || RPAD(NVL(HOR_TYP,'' ''),1,'' '') ¿ || RPAD(NVL(HRS_DEBB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_DEBB,0),''S000000'') || RPAD(NVL(HRS_FINB,'' ''),6,'' '') || TO_CHAR(NVL(HRJ_FINB,0),''S000000'') || RPAD(NVL(STATUT,'' ''),1,'' '')¿ || RPAD(NVL(TRIM(ANO1), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO2), ''##''),2,'' '') || RPAD(NVL(TRIM(ANO3), ''##''),2,'' '') || TO_CHAR(NVL(HOR_CAL,0),''S00000000000'') || RPAD(NVL(PROV_MP,'' ''),1,'' '')¿ || RPAD(NVL(PROV_PTR,'' ''),1,'' '') || TO_CHAR(NVL(HOR_MAT_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_T,0),''S00000000000'') || TO_CHAR(NVL(HOR_MAT_R,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_P,0),''S00000000000'') || TO_CHAR(NVL(HOR_POE_T,0),''S00000000000'')¿ || RPAD(NVL(TRIM(CYC_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_T), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_MAT_T), ''CYCNRS''),8,'' '')¿ || RPAD(NVL(TRIM(CYC_MAT_R), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_P), ''CYCNRS''),8,'' '') || RPAD(NVL(TRIM(CYC_POE_T), ''CYCNRS''),8,'' '') || TO_CHAR(NVL(LIEU_P,0),''S00000000000'')¿ || TO_CHAR(NVL(LIEU1,0),''S00000000000'') || TO_CHAR(NVL(LIEU2,0),''S00000000000'') || TO_CHAR(NVL(LIEU3,0),''S00000000000'') || TO_CHAR(NVL(LIEU4,0),''S00000000000'') || TO_CHAR(NVL(LIEU5,0),''S00000000000'')¿ || RPAD( NVL(TRIM(NAT_THE), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_THE,'' ''),8,'' '') || TO_CHAR(NVL(TPM_THE,0),''S00000000000'') || TO_CHAR(NVL(ROUND(TPM_THE/60, 3),0),''S00000000D000'') || CASE WHEN TPM_THE=0 THEN 0 ELSE 1 END¿FROM AD_MATJOU_TER¿WHERE DOM = ''2'' AND SOC = ''HRV'''
'TGE_GESTIL_MATJOUD','150','0',NULL,'1','AD_MATJOU','NUMPAC = ''$NUMPAC'' AND DAT_JOU < TO_DATE(''$DATE'',''YYYY/MM/DD'')','SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(RANG,0),''S000000'') || RPAD(NVL(FNATANO,'' ''),1,'' '')¿ || RPAD(NVL(NAT_TYP,'' ''),1,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT), ''NATNRS''),6,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT_S), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_NAT,'' ''),8,'' '') || TO_CHAR(NVL(TPM_NAT,0),''S00000000000'')¿ || TO_CHAR(NVL(ROUND(TPD_NAT/1000, 3),0),''S00000000D000'') || RPAD(NVL(TRIM(HRS_DEB),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_DEB),0),''S000000'') || RPAD(NVL(TRIM(HRS_FIN),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_FIN),0),''S000000'')¿ || RPAD(NVL(TRIM(CODPLJ),'' ''),1,'' '') || RPAD(NVL(TRIM(PROV_LIEU),'' ''),1,'' '') || TO_CHAR(NVL(LIEU,0),''S00000000000'') || RPAD(NVL(TRIM(POS), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_P,0),''S00000000000'') || RPAD(NVL(TRIM(POS_P), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_P), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(LIEU_T,0),''S00000000000'') || RPAD(NVL(TRIM(POS_T), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_T), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_R,0),''S00000000000'') || RPAD(NVL(TRIM(POS_R), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_R), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(QTE1,0),''S00000000000'') || TO_CHAR(NVL(QTE2,0),''S00000000000'')¿ || RPAD(NVL(TRIM(PROV_EVE),'' ''),1,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_DEB_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TRIM(Z2_VSTATE),'' ''),1,'' '')¿FROM AD_MATJOUD¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1  ON( T1.NUMPAC = ''$NUMPAC'' AND T1.NAT = TRIM(AD_MATJOUD.NAT))  ¿WHERE AD_MATJOUD.DOM = ''2'' AND AD_MATJOUD.SOC = ''HRV'' AND AD_MATJOUD.CODSEG=''B'' AND T1.ACTIF = ''O'''
'TGE_GESTIL_MATJOUD','151','0','BIS','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(RANG,0),''S000000'') || RPAD(NVL(FNATANO,'' ''),1,'' '')¿ || RPAD(NVL(NAT_TYP,'' ''),1,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT), ''NATNRS''),6,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT_S), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_NAT,'' ''),8,'' '') || TO_CHAR(NVL(TPM_NAT,0),''S00000000000'')¿ || TO_CHAR(NVL(ROUND(TPD_NAT/1000, 3),0),''S00000000D000'') || RPAD(NVL(TRIM(HRS_DEB),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_DEB),0),''S000000'') || RPAD(NVL(TRIM(HRS_FIN),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_FIN),0),''S000000'')¿ || RPAD(NVL(TRIM(CODPLJ),'' ''),1,'' '') || RPAD(NVL(TRIM(PROV_LIEU),'' ''),1,'' '') || TO_CHAR(NVL(LIEU,0),''S00000000000'') || RPAD(NVL(TRIM(POS), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_P,0),''S00000000000'') || RPAD(NVL(TRIM(POS_P), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_P), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(LIEU_T,0),''S00000000000'') || RPAD(NVL(TRIM(POS_T), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_T), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_R,0),''S00000000000'') || RPAD(NVL(TRIM(POS_R), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_R), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(QTE1,0),''S00000000000'') || TO_CHAR(NVL(QTE2,0),''S00000000000'')¿ || RPAD(NVL(TRIM(PROV_EVE),'' ''),1,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_DEB_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TRIM(Z2_VSTATE),'' ''),1,'' '')¿FROM AD_MATJOUD_BIS AD_MATJOUD¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1  ON( T1.NUMPAC = ''$NUMPAC'' AND T1.NAT = TRIM(AD_MATJOUD.NAT))  ¿WHERE AD_MATJOUD.DOM = ''2'' AND AD_MATJOUD.SOC = ''HRV'' AND AD_MATJOUD.CODSEG=''B'' AND T1.ACTIF = ''O'''
'TGE_GESTIL_MATJOUD','152','0','HIS','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(RANG,0),''S000000'') || RPAD(NVL(FNATANO,'' ''),1,'' '')¿ || RPAD(NVL(NAT_TYP,'' ''),1,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT), ''NATNRS''),6,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT_S), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_NAT,'' ''),8,'' '') || TO_CHAR(NVL(TPM_NAT,0),''S00000000000'')¿ || TO_CHAR(NVL(ROUND(TPD_NAT/1000, 3),0),''S00000000D000'') || RPAD(NVL(TRIM(HRS_DEB),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_DEB),0),''S000000'') || RPAD(NVL(TRIM(HRS_FIN),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_FIN),0),''S000000'')¿ || RPAD(NVL(TRIM(CODPLJ),'' ''),1,'' '') || RPAD(NVL(TRIM(PROV_LIEU),'' ''),1,'' '') || TO_CHAR(NVL(LIEU,0),''S00000000000'') || RPAD(NVL(TRIM(POS), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_P,0),''S00000000000'') || RPAD(NVL(TRIM(POS_P), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_P), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(LIEU_T,0),''S00000000000'') || RPAD(NVL(TRIM(POS_T), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_T), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_R,0),''S00000000000'') || RPAD(NVL(TRIM(POS_R), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_R), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(QTE1,0),''S00000000000'') || TO_CHAR(NVL(QTE2,0),''S00000000000'')¿ || RPAD(NVL(TRIM(PROV_EVE),'' ''),1,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_DEB_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TRIM(Z2_VSTATE),'' ''),1,'' '')¿FROM AD_MATJOUD_HIS AD_MATJOUD¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1  ON( T1.NUMPAC = ''$NUMPAC'' AND T1.NAT = TRIM(AD_MATJOUD.NAT))  ¿WHERE AD_MATJOUD.DOM = ''2'' AND AD_MATJOUD.SOC = ''HRV'' AND AD_MATJOUD.CODSEG=''B'' AND T1.ACTIF = ''O'''
'TGE_GESTIL_MATJOUD','153','0','TER','1','AD_MATJOU',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(DAT_JOU, ''YYYY/MM/DD''),''YYYYMMDD'') || RPAD(NVL(ENR,'' ''),1,'' '') || TO_CHAR(NVL(RANG,0),''S000000'') || RPAD(NVL(FNATANO,'' ''),1,'' '')¿ || RPAD(NVL(NAT_TYP,'' ''),1,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT), ''NATNRS''),6,'' '') || RPAD(NVL(TRIM(AD_MATJOUD.NAT_S), ''NATNRS''),6,'' '') || RPAD(NVL(TPS_NAT,'' ''),8,'' '') || TO_CHAR(NVL(TPM_NAT,0),''S00000000000'')¿ || TO_CHAR(NVL(ROUND(TPD_NAT/1000, 3),0),''S00000000D000'') || RPAD(NVL(TRIM(HRS_DEB),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_DEB),0),''S000000'') || RPAD(NVL(TRIM(HRS_FIN),'' ''),6,'' '') || TO_CHAR(NVL(TRIM(HRJ_FIN),0),''S000000'')¿ || RPAD(NVL(TRIM(CODPLJ),'' ''),1,'' '') || RPAD(NVL(TRIM(PROV_LIEU),'' ''),1,'' '') || TO_CHAR(NVL(LIEU,0),''S00000000000'') || RPAD(NVL(TRIM(POS), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_P,0),''S00000000000'') || RPAD(NVL(TRIM(POS_P), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_P), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(LIEU_T,0),''S00000000000'') || RPAD(NVL(TRIM(POS_T), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_T), ''EQUNRS''),6,'' '')¿ || TO_CHAR(NVL(LIEU_R,0),''S00000000000'') || RPAD(NVL(TRIM(POS_R), ''POSNRS''),10,'' '')|| RPAD(NVL(TRIM(EQU_R), ''EQUNRS''),6,'' '') || TO_CHAR(NVL(QTE1,0),''S00000000000'') || TO_CHAR(NVL(QTE2,0),''S00000000000'')¿ || RPAD(NVL(TRIM(PROV_EVE),'' ''),1,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_DEB_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN_EVE), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '') || RPAD(NVL(TRIM(Z2_VSTATE),'' ''),1,'' '')¿FROM AD_MATJOUD_TER AD_MATJOUD¿JOIN TGE_GESTIL_NAT_ETL@ADPLINK_DATA T1  ON( T1.NUMPAC = ''$NUMPAC'' AND T1.NAT = TRIM(AD_MATJOUD.NAT))  ¿WHERE AD_MATJOUD.DOM = ''2'' AND AD_MATJOUD.SOC = ''HRV'' AND AD_MATJOUD.CODSEG=''B'' AND T1.ACTIF = ''O'''
'TGE_GESTIL_MATCPT','160','0',NULL,'1','AD_MATCPT','NUMPAC = ''$NUMPAC'' AND DAT_CPT < TO_DATE(''$DATE'',''YYYY/MM/DD'')','SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(AD_MATCPT.MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(TRIM(AD_MATCPT.DAT_CPT), ''YYYY/MM/DD''),''YYYYMMDD'')¿|| TO_CHAR(NVL(TO_DATE(LEAD(AD_MATCPT.DAT_CPT) OVER (PARTITION BY AD_MATCPT.MAT, AD_MATCPT.CPT, AD_MATCPT.PER, BO_PERDAT.RANG, BO_MATCON_NUMSITU.NUMSITU ORDER BY AD_MATCPT.DAT_CPT), ''YYYY/MM/DD'')-1 , TO_DATE(AD_MATCPT.DAT_CPT, ''YYYY/MM/DD'')),''YYYYMMDD'')¿|| RPAD(NVL(TRIM(AD_MATCPT.CPT),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_MATCPT.PER),'' ''),6,'' '') || RPAD(NVL(AD_MATCPT.FFINPER,'' ''),1,'' '') || TO_CHAR(NVL(AD_MATCPT.ANNEE,0),''S000000'') || TO_CHAR(NVL(AD_MATCPT.NUMPER,0),''S00000000000'')¿|| TO_CHAR(NVL(ROUND(AD_MATCPT.VARJ/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'')|| TO_CHAR(NVL(ROUND(AD_MATCPT.VAL/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'') || RPAD(NVL(TGE_GESTIL_CPT_PER_ETL.UNITE,'' ''),20,'' '')¿|| TO_CHAR(NVL(BO_PERDAT.RANG,0),''S000000'')¿FROM AD_MATCPT¿JOIN BO_MATCON_NUMSITU ON ( BO_MATCON_NUMSITU.MAT = AD_MATCPT.MAT)¿JOIN TGE_GESTIL_CPT_PER_ETL@ADPLINK_DATA ON ( TGE_GESTIL_CPT_PER_ETL.NUMPAC = ''$NUMPAC'' AND TGE_GESTIL_CPT_PER_ETL.CPT = TRIM(AD_MATCPT.CPT) AND TGE_GESTIL_CPT_PER_ETL.PER = TRIM(AD_MATCPT.PER) )¿JOIN BO_PERDAT ON ( BO_PERDAT.NOM = AD_MATCPT.PER)¿WHERE AD_MATCPT.DOM=''2'' AND AD_MATCPT.SOC=''HRV'' ¿AND AD_MATCPT.DAT_CPT BETWEEN BO_MATCON_NUMSITU.ENTREE AND BO_MATCON_NUMSITU.SORTIE¿AND AD_MATCPT.DAT_CPT BETWEEN BO_PERDAT.DAT_DEB AND BO_PERDAT.DAT_FIN'
'TGE_GESTIL_MATCPT','161','0','BIS','1','AD_MATCPT',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(AD_MATCPT.MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(TRIM(AD_MATCPT.DAT_CPT), ''YYYY/MM/DD''),''YYYYMMDD'')¿|| TO_CHAR(NVL(TO_DATE(LEAD(AD_MATCPT.DAT_CPT) OVER (PARTITION BY AD_MATCPT.MAT, AD_MATCPT.CPT, AD_MATCPT.PER, BO_PERDAT.RANG, BO_MATCON_NUMSITU.NUMSITU ORDER BY AD_MATCPT.DAT_CPT), ''YYYY/MM/DD'')-1 , TO_DATE(AD_MATCPT.DAT_CPT, ''YYYY/MM/DD'')),''YYYYMMDD'')¿|| RPAD(NVL(TRIM(AD_MATCPT.CPT),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_MATCPT.PER),'' ''),6,'' '') || RPAD(NVL(AD_MATCPT.FFINPER,'' ''),1,'' '') || TO_CHAR(NVL(AD_MATCPT.ANNEE,0),''S000000'') || TO_CHAR(NVL(AD_MATCPT.NUMPER,0),''S00000000000'')¿|| TO_CHAR(NVL(ROUND(AD_MATCPT.VARJ/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'')|| TO_CHAR(NVL(ROUND(AD_MATCPT.VAL/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'') || RPAD(NVL(TGE_GESTIL_CPT_PER_ETL.UNITE,'' ''),20,'' '')¿|| TO_CHAR(NVL(BO_PERDAT.RANG,0),''S000000'')¿FROM AD_MATCPT_BIS AD_MATCPT¿JOIN BO_MATCON_NUMSITU ON ( BO_MATCON_NUMSITU.MAT = AD_MATCPT.MAT)¿JOIN TGE_GESTIL_CPT_PER_ETL@ADPLINK_DATA ON ( TGE_GESTIL_CPT_PER_ETL.NUMPAC = ''$NUMPAC'' AND TGE_GESTIL_CPT_PER_ETL.CPT = TRIM(AD_MATCPT.CPT) AND TGE_GESTIL_CPT_PER_ETL.PER = TRIM(AD_MATCPT.PER) )¿JOIN BO_PERDAT ON ( BO_PERDAT.NOM = AD_MATCPT.PER )¿WHERE AD_MATCPT.DOM=''2'' AND AD_MATCPT.SOC=''HRV'' ¿AND AD_MATCPT.DAT_CPT BETWEEN BO_MATCON_NUMSITU.ENTREE AND BO_MATCON_NUMSITU.SORTIE¿AND AD_MATCPT.DAT_CPT BETWEEN BO_PERDAT.DAT_DEB AND BO_PERDAT.DAT_FIN'
'TGE_GESTIL_MATCPT','162','0','HIS','1','AD_MATCPT',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(AD_MATCPT.MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(TRIM(AD_MATCPT.DAT_CPT), ''YYYY/MM/DD''),''YYYYMMDD'')¿|| TO_CHAR(NVL(TO_DATE(LEAD(AD_MATCPT.DAT_CPT) OVER (PARTITION BY AD_MATCPT.MAT, AD_MATCPT.CPT, AD_MATCPT.PER, BO_PERDAT.RANG, BO_MATCON_NUMSITU.NUMSITU ORDER BY AD_MATCPT.DAT_CPT), ''YYYY/MM/DD'')-1 , TO_DATE(AD_MATCPT.DAT_CPT, ''YYYY/MM/DD'')),''YYYYMMDD'')¿|| RPAD(NVL(TRIM(AD_MATCPT.CPT),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_MATCPT.PER),'' ''),6,'' '') || RPAD(NVL(AD_MATCPT.FFINPER,'' ''),1,'' '') || TO_CHAR(NVL(AD_MATCPT.ANNEE,0),''S000000'') || TO_CHAR(NVL(AD_MATCPT.NUMPER,0),''S00000000000'')¿|| TO_CHAR(NVL(ROUND(AD_MATCPT.VARJ/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'')|| TO_CHAR(NVL(ROUND(AD_MATCPT.VAL/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'') || RPAD(NVL(TGE_GESTIL_CPT_PER_ETL.UNITE,'' ''),20,'' '')¿|| TO_CHAR(NVL(BO_PERDAT.RANG,0),''S000000'')¿FROM AD_MATCPT_HIS AD_MATCPT¿JOIN BO_MATCON_NUMSITU ON ( BO_MATCON_NUMSITU.MAT = AD_MATCPT.MAT)¿JOIN TGE_GESTIL_CPT_PER_ETL@ADPLINK_DATA ON ( TGE_GESTIL_CPT_PER_ETL.NUMPAC = ''$NUMPAC'' AND TGE_GESTIL_CPT_PER_ETL.CPT = TRIM(AD_MATCPT.CPT) AND TGE_GESTIL_CPT_PER_ETL.PER = TRIM(AD_MATCPT.PER) )¿JOIN BO_PERDAT ON ( BO_PERDAT.NOM = AD_MATCPT.PER)¿WHERE AD_MATCPT.DOM=''2'' AND AD_MATCPT.SOC=''HRV'' ¿AND AD_MATCPT.DAT_CPT BETWEEN BO_MATCON_NUMSITU.ENTREE AND BO_MATCON_NUMSITU.SORTIE¿AND AD_MATCPT.DAT_CPT BETWEEN BO_PERDAT.DAT_DEB AND BO_PERDAT.DAT_FIN'
'TGE_GESTIL_MATCPT','163','0','TER','1','AD_MATCPT',NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(AD_MATCPT.MAT,'' ''),8,'' '') || TO_CHAR(TO_DATE(TRIM(AD_MATCPT.DAT_CPT), ''YYYY/MM/DD''),''YYYYMMDD'')¿|| TO_CHAR(NVL(TO_DATE(LEAD(AD_MATCPT.DAT_CPT) OVER (PARTITION BY AD_MATCPT.MAT, AD_MATCPT.CPT, AD_MATCPT.PER, BO_PERDAT.RANG, BO_MATCON_NUMSITU.NUMSITU ORDER BY AD_MATCPT.DAT_CPT), ''YYYY/MM/DD'')-1 , TO_DATE(AD_MATCPT.DAT_CPT, ''YYYY/MM/DD'')),''YYYYMMDD'')¿|| RPAD(NVL(TRIM(AD_MATCPT.CPT),'' ''),6,'' '') || RPAD(NVL(TRIM(AD_MATCPT.PER),'' ''),6,'' '') || RPAD(NVL(AD_MATCPT.FFINPER,'' ''),1,'' '') || TO_CHAR(NVL(AD_MATCPT.ANNEE,0),''S000000'') || TO_CHAR(NVL(AD_MATCPT.NUMPER,0),''S00000000000'')¿|| TO_CHAR(NVL(ROUND(AD_MATCPT.VARJ/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'')|| TO_CHAR(NVL(ROUND(AD_MATCPT.VAL/TGE_GESTIL_CPT_PER_ETL.DIVISEUR_VAL_VARJ,3),0),''S00000000D000'') || RPAD(NVL(TGE_GESTIL_CPT_PER_ETL.UNITE,'' ''),20,'' '')¿|| TO_CHAR(NVL(BO_PERDAT.RANG,0),''S000000'')¿FROM AD_MATCPT_TER AD_MATCPT¿JOIN BO_MATCON_NUMSITU ON ( BO_MATCON_NUMSITU.MAT = AD_MATCPT.MAT)¿JOIN TGE_GESTIL_CPT_PER_ETL@ADPLINK_DATA ON ( TGE_GESTIL_CPT_PER_ETL.NUMPAC = ''$NUMPAC'' AND TGE_GESTIL_CPT_PER_ETL.CPT = TRIM(AD_MATCPT.CPT) AND TGE_GESTIL_CPT_PER_ETL.PER = TRIM(AD_MATCPT.PER) )¿JOIN BO_PERDAT ON ( BO_PERDAT.NOM = AD_MATCPT.PER)¿WHERE AD_MATCPT.DOM=''2'' AND AD_MATCPT.SOC=''HRV'' ¿AND AD_MATCPT.DAT_CPT BETWEEN BO_MATCON_NUMSITU.ENTREE AND BO_MATCON_NUMSITU.SORTIE¿AND AD_MATCPT.DAT_CPT BETWEEN BO_PERDAT.DAT_DEB AND BO_PERDAT.DAT_FIN'
'TGE_GESTIL_MATHOR','170','0',NULL,'0',NULL,NULL,'WITH MATHORP AS ( SELECT MAT P_MAT, TO_DATE(TRIM(DAT_AFF),''YYYY/MM/DD'') P_DAT_AFF, TO_DATE(TRIM(DAT_FIN),''YYYY/MM/DD'') P_DAT_FIN, ENR P_ENR, CYCHOR P_CYCHOR, HOR P_HOR FROM AD_MATHOR WHERE ENR=''P'' )¿,MATHORT AS ( SELECT MAT T_MAT, TO_DATE(TRIM(DAT_AFF),''YYYY/MM/DD'') T_DAT_AFF, TO_DATE(TRIM(DAT_FIN),''YYYY/MM/DD'') T_DAT_FIN, ENR T_ENR, CYCHOR T_CYCHOR, HOR T_HOR FROM AD_MATHOR WHERE ENR=''T'' )¿,MATHORR AS ( SELECT MAT R_MAT, TO_DATE(TRIM(DAT_AFF),''YYYY/MM/DD'') R_DAT_AFF, TO_DATE(TRIM(DAT_FIN),''YYYY/MM/DD'') R_DAT_FIN, ENR R_ENR, CYCHOR R_CYCHOR, HOR R_HOR FROM AD_MATHOR WHERE ENR=''R'' )¿,MATHORAFF AS ( ¿SELECT DISTINCT MAT, TO_DATE(TRIM(DAT_AFF),''YYYY/MM/DD'') DAT_AFF FROM AD_MATHOR¿UNION¿SELECT DISTINCT MAT, TO_DATE(TRIM(DAT_FIN),''YYYY/MM/DD'')+1 DAT_AFF FROM AD_MATHOR WHERE DAT_FIN != ''2099/12/31''¿)¿,MATHORAFFP AS (¿SELECT MATHORAFF.MAT, MATHORAFF.DAT_AFF, LEAD(MATHORAFF.DAT_AFF) OVER (PARTITION BY MATHORAFF.MAT ORDER BY MATHORAFF.DAT_AFF ) DAT_FIN , MATHORP.P_CYCHOR, MATHORP.P_HOR, MATHORP.P_ENR, MATHORP.P_DAT_AFF, MATHORP.P_DAT_FIN¿FROM MATHORAFF¿JOIN MATHORP ON ( MATHORP.P_MAT = MATHORAFF.MAT)¿WHERE MATHORAFF.DAT_AFF BETWEEN MATHORP.P_DAT_AFF AND MATHORP.P_DAT_FIN ¿)¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MATHORAFFP.MAT,'' ''),8,'' '') || RPAD(NVL(NVL(NVL(R_ENR, T_ENR), P_ENR),'' ''),1,'' '')¿|| RPAD(NVL(TO_CHAR(MATHORAFFP.DAT_AFF,''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(TO_CHAR(NVL(MATHORAFFP.DAT_FIN-1, TO_DATE(''31/12/2099'', ''DD/MM/YYYY'')),''YYYYMMDD''),'' ''),8,'' '')  ¿|| DECODE(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(MATHORAFFP.P_HOR,0), ''T'', NVL(T_HOR,0), ''R'', NVL(R_HOR,0)), 0, ''C'', ''H'')¿|| RPAD(NVL(TRIM(MATHORR.R_CYCHOR), ''CYCNRS'') ,8,'' '') ¿|| TO_CHAR(TRIM(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(MATHORAFFP.P_HOR,0), ''T'', NVL(T_HOR,0), ''R'', NVL(R_HOR,0))),''S00000000000'')¿|| RPAD(NVL(TO_CHAR(MATHORAFFP.P_DAT_AFF,''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(TO_CHAR(MATHORAFFP.P_DAT_FIN,''YYYYMMDD''),'' ''),8,'' '') ¿|| RPAD(NVL(TRIM(MATHORAFFP.P_CYCHOR),''CYCNRS''),8,'' '') || TO_CHAR(NVL(TRIM(MATHORAFFP.P_HOR),0) ,''S00000000000'')¿|| RPAD(NVL(TO_CHAR(MATHORT.T_DAT_AFF,''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(TO_CHAR(MATHORT.T_DAT_FIN,''YYYYMMDD''),'' ''),8,'' '') ¿|| RPAD(NVL(TRIM(MATHORT.T_CYCHOR),''CYCNRS''),8,'' '') || TO_CHAR(NVL(TRIM(T_HOR),0) ,''S00000000000'')¿|| RPAD(NVL(TO_CHAR(MATHORR.R_DAT_AFF,''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(TO_CHAR(MATHORR.R_DAT_FIN,''YYYYMMDD''),'' ''),8,'' '') ¿|| RPAD(NVL(TRIM(MATHORR.R_CYCHOR), ''CYCNRS''),8,'' '') || TO_CHAR(NVL(TRIM(R_HOR),0) ,''S00000000000'')¿FROM MATHORAFFP¿LEFT OUTER JOIN MATHORT ON ( MATHORT.T_MAT = MATHORAFFP.MAT AND MATHORAFFP.DAT_AFF BETWEEN MATHORT.T_DAT_AFF AND MATHORT.T_DAT_FIN )¿LEFT OUTER JOIN MATHORR ON ( MATHORR.R_MAT = MATHORAFFP.MAT AND MATHORAFFP.DAT_AFF BETWEEN MATHORR.R_DAT_AFF AND MATHORR.R_DAT_FIN )'
'TGE_GESTIL_MATLIE','180','0',NULL,'0',NULL,NULL,'WITH MATLIEP AS ( SELECT MAT P_MAT , DECODE(TRIM(HRE_AFF), ''23:59'', TO_DATE(DAT_AFF, ''YYYY/MM/DD'')+1, TO_DATE(DAT_AFF||'' ''||HRE_AFF,''YYYY/MM/DD HH24:MI'')) P_DAT_AFF, ¿	DECODE(TRIM(HRE_FIN), ''23:59'', TO_DATE(DAT_FIN, ''YYYY/MM/DD'')+1, TO_DATE(DAT_FIN||'' ''||HRE_FIN,''YYYY/MM/DD HH24:MI'')) P_DAT_FIN, ENR P_ENR, LIEU P_LIEU, POS P_POS, EQU P_EQU, ¿	FHORPOE P_FHORPOE, HRS_DEB P_HRS_DEB, HRJ_DEB P_HRJ_DEB, HRS_FIN P_HRS_FIN, HRJ_FIN P_HRJ_FIN, POURC P_POURC ¿	FROM AD_MATLIE WHERE ENR=''P'' AND RANG=0 )¿, MATLIET AS ( SELECT MAT T_MAT , DECODE(TRIM(HRE_AFF), ''23:59'', TO_DATE(DAT_AFF, ''YYYY/MM/DD'')+1, TO_DATE(DAT_AFF||'' ''||HRE_AFF,''YYYY/MM/DD HH24:MI'')) T_DAT_AFF, ¿	DECODE(TRIM(HRE_FIN), ''23:59'', TO_DATE(DAT_FIN, ''YYYY/MM/DD'')+1, TO_DATE(DAT_FIN||'' ''||HRE_FIN,''YYYY/MM/DD HH24:MI'')) T_DAT_FIN, ENR T_ENR, LIEU T_LIEU, POS T_POS, EQU T_EQU,¿	FHORPOE T_FHORPOE, HRS_DEB T_HRS_DEB, HRJ_DEB T_HRJ_DEB, HRS_FIN T_HRS_FIN, HRJ_FIN T_HRJ_FIN, POURC T_POURC ¿	FROM AD_MATLIE WHERE ENR=''T'' AND RANG=0 )¿, MATLIER AS ( SELECT MAT R_MAT , DECODE(TRIM(HRE_AFF), ''23:59'', TO_DATE(DAT_AFF, ''YYYY/MM/DD'')+1, TO_DATE(DAT_AFF||'' ''||HRE_AFF,''YYYY/MM/DD HH24:MI'')) R_DAT_AFF, ¿	DECODE(TRIM(HRE_FIN), ''23:59'', TO_DATE(DAT_FIN, ''YYYY/MM/DD'')+1, TO_DATE(DAT_FIN||'' ''||HRE_FIN,''YYYY/MM/DD HH24:MI'')) R_DAT_FIN, ENR R_ENR, LIEU R_LIEU, POS R_POS, EQU R_EQU,¿	FHORPOE R_FHORPOE, HRS_DEB R_HRS_DEB, HRJ_DEB R_HRJ_DEB, HRS_FIN R_HRS_FIN, HRJ_FIN R_HRJ_FIN, POURC R_POURC ¿	FROM AD_MATLIE WHERE ENR=''R'' AND RANG=0 )¿, MATLIEAFF AS ( SELECT DISTINCT MAT, DECODE(TRIM(HRE_AFF), ''23:59'', TO_DATE(DAT_AFF, ''YYYY/MM/DD'')+1, TO_DATE(DAT_AFF||'' ''||HRE_AFF,''YYYY/MM/DD HH24:MI'')) DAT_AFF ¿	FROM AD_MATLIE WHERE RANG=0¿		UNION¿	SELECT DISTINCT MAT, DECODE(TRIM(HRE_FIN), ''23:59'', TO_DATE(DAT_FIN, ''YYYY/MM/DD'')+1, TO_DATE(DAT_FIN||'' ''||HRE_FIN,''YYYY/MM/DD HH24:MI'')) DAT_AFF ¿	FROM AD_MATLIE WHERE RANG=0 AND DAT_FIN != ''2099/12/31'')¿,MATLIEAFFP AS ( SELECT MATLIEAFF.MAT, MATLIEAFF.DAT_AFF, LEAD(MATLIEAFF.DAT_AFF) OVER (PARTITION BY MATLIEAFF.MAT ORDER BY MATLIEAFF.DAT_AFF ) DAT_FIN, MATLIEP.P_LIEU, MATLIEP.P_POS¿	, MATLIEP.P_EQU, MATLIEP.P_ENR, MATLIEP.P_DAT_AFF, MATLIEP.P_DAT_FIN, MATLIEP.P_FHORPOE, MATLIEP.P_HRS_DEB, MATLIEP.P_HRJ_DEB, MATLIEP.P_HRS_FIN, MATLIEP.P_HRJ_FIN, MATLIEP.P_POURC¿	FROM MATLIEAFF¿	LEFT OUTER JOIN MATLIEP ON ( MATLIEP.P_MAT = MATLIEAFF.MAT AND MATLIEAFF.DAT_AFF >= MATLIEP.P_DAT_AFF AND MATLIEAFF.DAT_AFF < MATLIEP.P_DAT_FIN))¿SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MATLIEAFFP.MAT,'' ''),8,'' '') || RPAD(NVL(TO_CHAR(MATLIEAFFP.DAT_AFF,''YYYYMMDDHH24MI''),'' ''),12,'' '')¿|| RPAD(NVL(TO_CHAR(MATLIEAFFP.DAT_FIN,''YYYYMMDDHH24MI''),''210001010000''),12,'' '')¿|| RPAD(NVL(NVL(NVL(R_ENR, T_ENR), P_ENR),'' '') ,1,'' '')  || DECODE(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(MATLIEAFFP.P_LIEU,0), ''T'', NVL(MATLIET.T_LIEU,0), ''R'', NVL(MATLIER.R_LIEU,0)), 0, ''P'', ''L'')¿|| TO_CHAR(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(MATLIEAFFP.P_LIEU,0), ''T'', NVL(MATLIET.T_LIEU,0), ''R'', NVL(MATLIER.R_LIEU,0), 0) ,''S00000000000'')¿|| RPAD(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(TRIM(MATLIEAFFP.P_POS),''POSNRS''), ''T'', NVL(TRIM(MATLIET.T_POS),''POSNRS''), ''R'', NVL(TRIM(MATLIER.R_POS),''POSNRS''), ''POSNRS''),10,'' '') ¿|| RPAD(DECODE(NVL(NVL(R_ENR, T_ENR), P_ENR), ''P'', NVL(TRIM(MATLIEAFFP.P_EQU),''EQUNRS''), ''T'', NVL(TRIM(MATLIET.T_EQU),''EQUNRS''), ''R'', NVL(TRIM(MATLIER.R_EQU),''EQUNRS''), ''EQUNRS''),6,'' '')¿|| RPAD(NVL(TO_CHAR(MATLIEAFFP.P_DAT_AFF,''YYYYMMDDHH24MI''),'' ''),12,'' '') || RPAD(NVL(TO_CHAR(MATLIEAFFP.P_DAT_FIN,''YYYYMMDDHH24MI''),'' ''),12,'' '')¿|| TO_CHAR(NVL(MATLIEAFFP.P_LIEU,0) ,''S00000000000'') || RPAD(NVL(TRIM(MATLIEAFFP.P_POS),''POSNRS''),10,'' '') || RPAD(NVL(TRIM(MATLIEAFFP.P_EQU),''EQUNRS''),6,'' '')¿|| RPAD(NVL(MATLIEAFFP.P_FHORPOE,0),1,'' '') || RPAD(NVL(MATLIEAFFP.P_HRS_DEB,'' ''),6,'' '')|| TO_CHAR(NVL(MATLIEAFFP.P_HRJ_DEB,0) ,''S000000'')¿|| RPAD(NVL(MATLIEAFFP.P_HRS_FIN,'' ''),6,'' '') || TO_CHAR(NVL(MATLIEAFFP.P_HRJ_FIN,0) ,''S000000'') || TO_CHAR(NVL(MATLIEAFFP.P_POURC,0) ,''S000000'') ¿|| RPAD(NVL(TO_CHAR(MATLIET.T_DAT_AFF,''YYYYMMDDHH24MI''),'' ''),12,'' '') || RPAD(NVL(TO_CHAR(MATLIET.T_DAT_FIN,''YYYYMMDDHH24MI''),'' ''),12,'' '')¿|| TO_CHAR(NVL(MATLIET.T_LIEU,0) ,''S00000000000'') || RPAD(NVL(TRIM(MATLIET.T_POS),''POSNRS''),10,'' '') || RPAD(NVL(TRIM(MATLIET.T_EQU),''EQUNRS''),6,'' '')¿|| RPAD(NVL(MATLIET.T_FHORPOE,0),1,'' '') || RPAD(NVL(MATLIET.T_HRS_DEB,'' ''),6,'' '')|| TO_CHAR(NVL(MATLIET.T_HRJ_DEB,0) ,''S000000'')¿|| RPAD(NVL(MATLIET.T_HRS_FIN,'' ''),6,'' '') || TO_CHAR(NVL(MATLIET.T_HRJ_FIN,0) ,''S000000'') || TO_CHAR(NVL(MATLIET.T_POURC,0) ,''S000000'') ¿|| RPAD(NVL(TO_CHAR(MATLIER.R_DAT_AFF,''YYYYMMDDHH24MI''),'' ''),12,'' '') || RPAD(NVL(TO_CHAR(MATLIER.R_DAT_FIN,''YYYYMMDDHH24MI''),'' ''),12,'' '')¿|| TO_CHAR(NVL(MATLIER.R_LIEU,0) ,''S00000000000'') || RPAD(NVL(TRIM(MATLIER.R_POS), ''POSNRS''),10,'' '') || RPAD(NVL(TRIM(MATLIER.R_EQU), ''EQUNRS''),6,'' '')¿|| RPAD(NVL(MATLIER.R_FHORPOE,0),1,'' '') || RPAD(NVL(MATLIER.R_HRS_DEB,'' ''),6,'' '')|| TO_CHAR(NVL(MATLIER.R_HRJ_DEB,0) ,''S000000'')¿|| RPAD(NVL(MATLIER.R_HRS_FIN,'' ''),6,'' '') || TO_CHAR(NVL(MATLIER.R_HRJ_FIN,0) ,''S000000'') || TO_CHAR(NVL(MATLIER.R_POURC,0) ,''S000000'') ¿FROM MATLIEAFFP¿LEFT OUTER JOIN MATLIET ON ( MATLIET.T_MAT = MATLIEAFFP.MAT AND MATLIEAFFP.DAT_AFF >= MATLIET.T_DAT_AFF AND MATLIEAFFP.DAT_AFF < MATLIET.T_DAT_FIN )¿LEFT OUTER JOIN MATLIER ON ( MATLIER.R_MAT = MATLIEAFFP.MAT AND MATLIEAFFP.DAT_AFF >= MATLIER.R_DAT_AFF AND MATLIEAFFP.DAT_AFF < MATLIER.R_DAT_FIN )'
'TGE_GESTIL_MATBAD','190','0',NULL,'0',NULL,NULL,'SELECT RPAD(NVL(''$NUMPAC'','' ''),6,'' '') || RPAD(NVL(MAT,'' ''),8,'' '') || RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_AFF), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(TO_CHAR(TO_DATE(TRIM(DAT_FIN), ''YYYY/MM/DD''),''YYYYMMDD''),'' ''),8,'' '')¿|| RPAD(NVL(BADGE,'' ''),8,'' '')¿|| RPAD(NVL(LIB,'' ''),30,'' '')¿|| RPAD(NVL(CAT,'' ''),2,'' '')¿|| RPAD(NVL(AFFCPT,'' ''),6,'' '')¿|| RPAD(NVL(REGA,'' ''),2,'' '')¿|| RPAD(NVL(REGT,'' ''),2,'' '')¿|| RPAD(NVL(REGS,'' ''),2,'' '')¿|| RPAD(NVL(F_TPS_REEL,'' ''),1,'' '')¿|| RPAD(NVL(F_TRAIT_POE,'' ''),1,'' '')¿FROM AD_MATBAD¿WHERE ENR = ''M'''
##
SYS_TRT_TOMAKE
=SQL=
DECLARE
	REC_EXIST PLS_INTEGER := 0;
BEGIN
	SELECT COUNT(*) INTO REC_EXIST FROM SYS_TRT_TOMAKE WHERE ID_TRT = 'Traitement_Bo';
	IF REC_EXIST = 1 THEN
		RETURN;
	END IF;
  	INSERT INTO SYS_TRT_TOMAKE(ID_TRT,REQUESTEDGO_OR_FREQUENCY) VALUES ('Traitement_Bo','00');
END;
##
STD_TABIDENT
==
DELETE FROM STD_TABIDENT WHERE ident in ('TGE_GESTIL_NAT_ETL','TGE_GESTIL_CPT_PER_ETL')
'TGE_GESTIL_CPT_PER_ETL','Compteurs/périodes à consolider dans ADP Link','TGE_GESTIL_CPT_PER_ETL','U',NULL,'TG','O','O','N','Couples de compteur / période Gestil à consolider dans ADP Link. Le diviseur sert à ramener le format interne de certains compteurs Gestil à des unités traditionnelles. Par exemple 1 jour est souvent compté dans le jeu d''instructions avec un facteur 1000.','0','0'
'TGE_GESTIL_NAT_ETL','Natures d''heures à consolider dans ADP Link','TGE_GESTIL_NAT_ETL','U',NULL,'TG','O','O','N','Natures d''heures Gestil à consolider dans ADP Link.','0','0'
##
STD_TABDESCCOL
==
DELETE FROM STD_TABDESCCOL WHERE ident in ('TGE_GESTIL_NAT_ETL','TGE_GESTIL_CPT_PER_ETL')
'TGE_GESTIL_CPT_PER_ETL','0','Pac','O','O','O','O',NULL,NULL,NULL,'NUMPAC','X','6','N',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'1','N',NULL
'TGE_GESTIL_CPT_PER_ETL','1','Compteur','O','O','O','O',NULL,NULL,NULL,'CPT','X','6','N',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'2','N',NULL
'TGE_GESTIL_CPT_PER_ETL','2','Période','O','O','O','O',NULL,NULL,NULL,'PER','X','6','N',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'3','N',NULL
'TGE_GESTIL_CPT_PER_ETL','3','Diviseur','N','N','O','O',NULL,NULL,NULL,'DIVISEUR_VAL_VARJ','N','11','O',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'4','N',NULL
'TGE_GESTIL_CPT_PER_ETL','4','Unité','N','N','O','O',NULL,NULL,NULL,'UNITE','X','20','O',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'5','N',NULL
'TGE_GESTIL_CPT_PER_ETL','5','Actif O/N','N','N','O','O',NULL,NULL,NULL,'ACTIF','X','1','O',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'6','N',NULL
'TGE_GESTIL_NAT_ETL','0','Pac','O','O','O','O',NULL,NULL,NULL,'NUMPAC','X','6','N',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'1','N',NULL
'TGE_GESTIL_NAT_ETL','1','Nature d''heures','O','O','O','O',NULL,NULL,NULL,'NAT','X','8','N',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'2','N',NULL
'TGE_GESTIL_NAT_ETL','2','Actif O/N','N','N','O','O',NULL,NULL,NULL,'ACTIF','X','1','O',NULL,NULL,NULL,'0','0',NULL,NULL,NULL,NULL,'3','N',NULL
##
DROP_CONSTRAINT
=SQL=
BEGIN
	FOR R IN ( SELECT TABLE_NAME , CONSTRAINT_NAME FROM USER_CONSTRAINTS WHERE CONSTRAINT_TYPE = 'R' AND TABLE_NAME IN ('TGE_GESTIL_LISNATD','TGE_GESTIL_CPT','TGE_GESTIL_MATJOU','TGE_GESTIL_MATJOUD','TGE_GESTIL_MATCPT','TGE_GESTIL_MATHOR','TGE_GESTIL_MATLIE') ORDER BY TABLE_NAME ASC ,CONSTRAINT_NAME ASC )
	LOOP
		EXECUTE IMMEDIATE 'ALTER TABLE '||R.TABLE_NAME ||' DROP CONSTRAINT '||R.CONSTRAINT_NAME ;
	END LOOP;
END;
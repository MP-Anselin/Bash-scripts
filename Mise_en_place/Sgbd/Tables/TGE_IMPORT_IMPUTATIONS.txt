##
TAG_CHARSET=@€ιθη
##
TGE_IMPORT_IMPUTATIONS
=SQL IFNOTEXIST=TGE_IMPORT_IMPUTATIONS=
CREATE TABLE TGE_IMPORT_IMPUTATIONS (LOGIN VARCHAR2(32), DATE_IMPORT VARCHAR2(200), NUMLIGNE NUMBER  , MATRICULE VARCHAR2(32), NUMPAC VARCHAR2(6), PAIEZAD VARCHAR2(8), PACMAT VARCHAR2(8), CODE_ENREGISTREMENT VARCHAR2(2), CLE VARCHAR2(1), NOMBRE_UNITE NUMBER(11,4) , CODE_UNITE VARCHAR2(3), CODE_IMPUTATION VARCHAR2(18), CODE_ANNULATION VARCHAR2(1), CODE_CHRONOLOGIQUE VARCHAR2(6), ORIGINE VARCHAR2(1), CODE_REMPLACEMENT VARCHAR2(1), CODE_UTILISATEUR VARCHAR2(8), DATE_SAISIE VARCHAR2(8) , HEURE_SAISIE VARCHAR2(6), DATE_EFFET VARCHAR2(8) , PERIODE VARCHAR2(6), PERIODE_EFFET VARCHAR2(8), TYPE_TRAITEMENT VARCHAR2(2), POPULATION VARCHAR2(3), CLASSE_DISTRIB VARCHAR2(3), TYPE_PAIE VARCHAR2(1), CODE_MONNAIE VARCHAR2(1), DONNEE_RETRO VARCHAR2(1), ERREURS VARCHAR2(3000), STATUT VARCHAR2(8), WARNINGS VARCHAR2(3000), FSED_PAIEZAD VARCHAR2(8),PRIMARY KEY (LOGIN,DATE_IMPORT,NUMLIGNE))
##
TGE_IMPORT_IMPUTATIONS
=SQL=
DECLARE
NOMBRE_UNITE_TYPE VARCHAR(10);
BEGIN
EXECUTE IMMEDIATE 'SELECT data_type  FROM user_tab_cols WHERE table_name = ''TGE_IMPORT_IMPUTATIONS'' AND column_name = ''NOMBRE_UNITE''' into NOMBRE_UNITE_TYPE ;
IF(NOMBRE_UNITE_TYPE='NUMBER') THEN
 EXECUTE IMMEDIATE 'CREATE TABLE TGE_IMPORT_IMPUTATIONS_2
   ( LOGIN VARCHAR2(32) NOT NULL ENABLE, 
	DATE_IMPORT VARCHAR2(200) NOT NULL ENABLE, 
	NUMLIGNE NUMBER NOT NULL ENABLE, 
	MATRICULE VARCHAR2(32), 
	NUMPAC VARCHAR2(6), 
	PAIEZAD VARCHAR2(8), 
	PACMAT VARCHAR2(8), 
	CODE_ENREGISTREMENT VARCHAR2(2), 
	CLE VARCHAR2(1),
	NOMBRE_UNITE VARCHAR2(500), 
	CODE_UNITE VARCHAR2(3), 
	CODE_IMPUTATION VARCHAR2(18), 
	CODE_ANNULATION VARCHAR2(1), 
	CODE_CHRONOLOGIQUE VARCHAR2(6), 
	ORIGINE VARCHAR2(1), 
	CODE_REMPLACEMENT VARCHAR2(1), 
	CODE_UTILISATEUR VARCHAR2(8), 
	DATE_SAISIE VARCHAR2(8) , 
	HEURE_SAISIE VARCHAR2(6), 
	DATE_EFFET VARCHAR2(8) , 
	PERIODE VARCHAR2(6), 
	PERIODE_EFFET VARCHAR2(8), 
	TYPE_TRAITEMENT VARCHAR2(2), 
	POPULATION VARCHAR2(3), 
	CLASSE_DISTRIB VARCHAR2(3), 
	TYPE_PAIE VARCHAR2(1), 
	CODE_MONNAIE VARCHAR2(1), 
	DONNEE_RETRO VARCHAR2(1), 
	ERREURS VARCHAR2(3000), 
	STATUT VARCHAR2(8), 
	WARNINGS VARCHAR2(3000), 
	FSED_PAIEZAD VARCHAR2(8),
	PRIMARY KEY (LOGIN,DATE_IMPORT,NUMLIGNE))';
	 
 EXECUTE IMMEDIATE 'INSERT INTO TGE_IMPORT_IMPUTATIONS_2 ( LOGIN , 
	DATE_IMPORT , 
	NUMLIGNE , 
	MATRICULE , 
	NUMPAC , 
	PAIEZAD , 
	PACMAT , 
	CODE_ENREGISTREMENT , 
	CLE ,
	NOMBRE_UNITE , 
	CODE_UNITE , 
	CODE_IMPUTATION , 
	CODE_ANNULATION , 
	CODE_CHRONOLOGIQUE , 
	ORIGINE , 
	CODE_REMPLACEMENT , 
	CODE_UTILISATEUR , 
	DATE_SAISIE , 
	HEURE_SAISIE , 
	DATE_EFFET , 
	PERIODE , 
	PERIODE_EFFET , 
	TYPE_TRAITEMENT , 
	POPULATION , 
	CLASSE_DISTRIB , 
	TYPE_PAIE , 
	CODE_MONNAIE , 
	DONNEE_RETRO , 
	ERREURS , 
	STATUT , 
	WARNINGS , 
	FSED_PAIEZAD ) (SELECT LOGIN , 
	DATE_IMPORT , 
	NUMLIGNE , 
	MATRICULE , 
	NUMPAC , 
	PAIEZAD , 
	PACMAT , 
	CODE_ENREGISTREMENT , 
	CLE ,
	TO_CHAR(NOMBRE_UNITE), 
	CODE_UNITE , 
	CODE_IMPUTATION , 
	CODE_ANNULATION , 
	CODE_CHRONOLOGIQUE , 
	ORIGINE , 
	CODE_REMPLACEMENT , 
	CODE_UTILISATEUR , 
	DATE_SAISIE , 
	HEURE_SAISIE , 
	DATE_EFFET , 
	PERIODE , 
	PERIODE_EFFET , 
	TYPE_TRAITEMENT , 
	POPULATION , 
	CLASSE_DISTRIB , 
	TYPE_PAIE , 
	CODE_MONNAIE , 
	DONNEE_RETRO , 
	ERREURS , 
	STATUT , 
	WARNINGS , 
	FSED_PAIEZAD from TGE_IMPORT_IMPUTATIONS)' ;
	 
  EXECUTE IMMEDIATE 'RENAME  TGE_IMPORT_IMPUTATIONS TO  TGE_IMPORT_IMPUTATIONS_tmp' ;
  EXECUTE IMMEDIATE 'RENAME TGE_IMPORT_IMPUTATIONS_2  to  TGE_IMPORT_IMPUTATIONS' ;
  EXECUTE IMMEDIATE 'DROP TABLE TGE_IMPORT_IMPUTATIONS_tmp';
  EXECUTE IMMEDIATE 'COMMIT';
END IF ;
END;

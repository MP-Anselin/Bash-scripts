##
TAG_CHARSET=@€ιθη
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=NUMFICHE_ESERVICE=
ALTER TABLE HELPDESK_FICHE ADD NUMFICHE_ESERVICE varchar2(13)
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=NUMPAC=
ALTER TABLE HELPDESK_FICHE ADD NUMPAC varchar2(10)
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=ISUX=
ALTER TABLE HELPDESK_FICHE ADD ISUX varchar2(2)
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=MATRIC_ESCALADE=
ALTER TABLE HELPDESK_FICHE ADD MATRIC_ESCALADE varchar2(32)
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=COMRRH=
ALTER TABLE HELPDESK_FICHE ADD COMRRH varchar2(4000)
##
HELPDESK_FICHE
=SQL=
DECLARE
DATEFICHE_TYPE varchar2(60);
DATEMODIF_TYPE varchar2(60);
BEGIN
EXECUTE IMMEDIATE 'SELECT data_type  FROM user_tab_cols WHERE table_name = ''HELPDESK_FICHE'' AND column_name = ''DATEFICHE''' into DATEFICHE_TYPE ;
EXECUTE IMMEDIATE 'SELECT data_type  FROM user_tab_cols WHERE table_name = ''HELPDESK_FICHE'' AND column_name = ''DATEMODIF''' into DATEMODIF_TYPE ;
IF(DATEFICHE_TYPE='VARCHAR2' AND DATEMODIF_TYPE='VARCHAR2') THEN
 EXECUTE IMMEDIATE 'CREATE TABLE HELPDESK_FICHE_2
   ( CODFICHE NUMBER NOT NULL ENABLE, 
	LIBFICHE VARCHAR2(400), 
	DATEFICHE DATE, 
	AUTEURFICHE VARCHAR2(100), 
	TYPFICHE VARCHAR2(1), 
	GRAVFICHE VARCHAR2(1), 
	DATBUTFICHE VARCHAR2(8), 
	ENJEUFICHE VARCHAR2(4000), 
	CODCLIENT NUMBER, 
	TYPDOM VARCHAR2(3), 
	CODMOD NUMBER, 
	VERSION VARCHAR2(20), 
	DESCFICHE VARCHAR2(4000), 
	CODSTA NUMBER, 
	DATEPLANIFINIT VARCHAR2(10), 
	DATEPLANIFACT VARCHAR2(8), 
	CODPRJT VARCHAR2(10), 
	NUMDIT VARCHAR2(10), 
	COMARBITRAGE VARCHAR2(4000), 
	COMRD VARCHAR2(4000), 
	TRIMPLANIFACT VARCHAR2(20), 
	VERREA VARCHAR2(20), 
	MACROANA NUMBER(*,3), 
	MACRODEV NUMBER(*,3), 
	FILEJOIN VARCHAR2(255), 
	INDICATEURPLANIF VARCHAR2(20), 
	NUMPTS VARCHAR2(50), 
	RESPNIV1 VARCHAR2(150), 
	CODEUSER VARCHAR2(100), 
	MATRIC VARCHAR2(32), 
	DATEMODIF DATE, 
	MATRICBENEFICIAIRE VARCHAR2(32), 
	DADP VARCHAR2(1), 
	DADPNUMBER VARCHAR2(25), 
	MACROSUP NUMBER, 
	LASTUSER VARCHAR2(200), 
	COMANALYSE VARCHAR2(4000), 
	CODFICHELIEE NUMBER, 
	RAF NUMBER, 
	CODTST NUMBER DEFAULT 0, 
	TSTBPI NUMBER DEFAULT 0, 
	IMPACT NUMBER DEFAULT 0, 
	FICHEORIGINE VARCHAR2(1), 
	FICHEIMPACTAIDE VARCHAR2(1), 
	PRIORITE VARCHAR2(1), 
	RELEASE VARCHAR2(20), 
	L31 VARCHAR2(1), 
	L50 VARCHAR2(1), 
	L71 VARCHAR2(1), 
	NUMFICHE_ESERVICE VARCHAR2(13), 
	NUMPAC VARCHAR2(10), 
	ISUX VARCHAR2(2), 
	MATRIC_ESCALADE VARCHAR2(32), 
	COMRRH VARCHAR2(4000), 
	PRIMARY KEY (CODFICHE))';
	 
 EXECUTE IMMEDIATE 'INSERT INTO HELPDESK_FICHE_2( CODFICHE, 
 LIBFICHE ,
	 DATEFICHE, 
	 AUTEURFICHE, 
	 TYPFICHE ,
	 GRAVFICHE ,
	 DATBUTFICHE, 
	 ENJEUFICHE ,
	 CODCLIENT, 
	 TYPDOM ,
	 CODMOD, 
	 VERSION ,
	 DESCFICHE, 
	 CODSTA, 
	 DATEPLANIFINIT, 
	 DATEPLANIFACT ,
	 CODPRJT ,
	 NUMDIT ,
	 COMARBITRAGE, 
	 COMRD ,
	 TRIMPLANIFACT, 
	 VERREA ,
	 MACROANA , 
	 MACRODEV , 
	 FILEJOIN, 
	 INDICATEURPLANIF, 
	 NUMPTS ,
	 RESPNIV1, 
	 CODEUSER ,
	 MATRIC ,
	 DATEMODIF, 
	 MATRICBENEFICIAIRE, 
	 DADP ,
	 DADPNUMBER, 
	 MACROSUP, 
	 LASTUSER ,
	 COMANALYSE, 
	 CODFICHELIEE, 
	 RAF, 
	 CODTST, 
	 TSTBPI, 
	 IMPACT, 
	 FICHEORIGINE ,
	 FICHEIMPACTAIDE ,
	 PRIORITE ,
	 RELEASE ,
	 L31, 
	 L50, 
	 L71 ,
	 NUMFICHE_ESERVICE ,
	 NUMPAC ,
	 ISUX ,
	 MATRIC_ESCALADE ,
	 COMRRH ) (SELECT CODFICHE, 
 LIBFICHE ,
	 TO_DATE(DATEFICHE,''yyyy/mm/dd''), 
	 AUTEURFICHE, 
	 TYPFICHE ,
	 GRAVFICHE ,
	 DATBUTFICHE, 
	 ENJEUFICHE ,
	 CODCLIENT, 
	 TYPDOM ,
	 CODMOD, 
	 VERSION ,
	 DESCFICHE, 
	 CODSTA, 
	 DATEPLANIFINIT, 
	 DATEPLANIFACT ,
	 CODPRJT ,
	 NUMDIT ,
	 COMARBITRAGE, 
	 COMRD ,
	 TRIMPLANIFACT, 
	 VERREA ,
	 MACROANA , 
	 MACRODEV , 
	 FILEJOIN, 
	 INDICATEURPLANIF, 
	 NUMPTS ,
	 RESPNIV1, 
	 CODEUSER ,
	 MATRIC ,
   TO_DATE(DATEMODIF,''yyyy/mm/dd''),
	 MATRICBENEFICIAIRE, 
	 DADP ,
	 DADPNUMBER, 
	 MACROSUP, 
	 LASTUSER ,
	 COMANALYSE, 
	 CODFICHELIEE, 
	 RAF, 
	 CODTST, 
	 TSTBPI, 
	 IMPACT, 
	 FICHEORIGINE ,
	 FICHEIMPACTAIDE ,
	 PRIORITE ,
	 RELEASE ,
	 L31, 
	 L50, 
	 L71 ,
	 NUMFICHE_ESERVICE ,
	 NUMPAC ,
	 ISUX ,
	 MATRIC_ESCALADE ,
	 COMRRH from HELPDESK_FICHE)' ;
	 
  EXECUTE IMMEDIATE 'RENAME  HELPDESK_FICHE TO  HELPDESK_FICHE_tmp' ;
  EXECUTE IMMEDIATE 'RENAME HELPDESK_FICHE_2  to  HELPDESK_FICHE' ;
  EXECUTE IMMEDIATE 'DROP TABLE HELPDESK_FICHE_tmp';
  EXECUTE IMMEDIATE 'COMMIT';
END IF ;
END;
##
HELPDESK_FICHE
=SQL=
BEGIN
EXECUTE IMMEDIATE 'CREATE TABLE HELPDESK_FICHE_inter
  (
    CODFICHE           NUMBER NOT NULL ENABLE,
    LIBFICHE           VARCHAR2(400),
    DATEFICHE          DATE,
    AUTEURFICHE        VARCHAR2(100),
    TYPFICHE           VARCHAR2(1),
    GRAVFICHE          VARCHAR2(1),
    DATBUTFICHE        VARCHAR2(8),
    TYPDOM             VARCHAR2(3),
    CODMOD             NUMBER,
    DESCFICHE          VARCHAR2(4000),
    CODSTA             NUMBER,
    DATEPLANIFINIT     VARCHAR2(10),
    DATEPLANIFACT      VARCHAR2(8),
    COMRD              VARCHAR2(4000),
    FILEJOIN           VARCHAR2(255),
    INDICATEURPLANIF   VARCHAR2(20),
    RESPNIV1           VARCHAR2(150),
    CODEUSER           VARCHAR2(100),
    MATRIC             VARCHAR2(32),
    DATEMODIF          DATE,
    MATRICBENEFICIAIRE VARCHAR2(32),
    LASTUSER           VARCHAR2(200),
    CODFICHELIEE       NUMBER,
    FICHEORIGINE       VARCHAR2(1),
    PRIORITE           VARCHAR2(1),
    NUMFICHE_ESERVICE  VARCHAR2(13),
    NUMPAC             VARCHAR2(10),
    ISUX               VARCHAR2(2),
    MATRIC_ESCALADE    VARCHAR2(32),
    COMRRH             VARCHAR2(4000),
    PRIMARY KEY (CODFICHE)
  )';
 
 EXECUTE IMMEDIATE 'INSERT
INTO HELPDESK_FICHE_inter
  (
    CODFICHE,
    LIBFICHE ,
    DATEFICHE,
    AUTEURFICHE,
    TYPFICHE ,
    GRAVFICHE ,
    DATBUTFICHE,
    TYPDOM ,
    CODMOD,
    DESCFICHE,
    CODSTA,
    DATEPLANIFINIT,
    DATEPLANIFACT ,
    COMRD ,
    FILEJOIN,
    INDICATEURPLANIF,
    RESPNIV1,
    CODEUSER ,
    MATRIC ,
    DATEMODIF,
    MATRICBENEFICIAIRE,
    LASTUSER ,
    CODFICHELIEE,
    FICHEORIGINE ,
    PRIORITE ,
    NUMFICHE_ESERVICE ,
    NUMPAC ,
    ISUX ,
    MATRIC_ESCALADE ,
    COMRRH
  )
  (SELECT CODFICHE,
      LIBFICHE ,
      DATEFICHE,
      AUTEURFICHE,
      TYPFICHE ,
      GRAVFICHE ,
      DATBUTFICHE,
      TYPDOM ,
      CODMOD,
      DESCFICHE,
      CODSTA,
      DATEPLANIFINIT,
      DATEPLANIFACT ,
      COMRD ,
      FILEJOIN,
      INDICATEURPLANIF,
      RESPNIV1,
      CODEUSER ,
      MATRIC ,
      DATEMODIF,
      MATRICBENEFICIAIRE,
      LASTUSER ,
      CODFICHELIEE,
      FICHEORIGINE ,
      PRIORITE ,
      NUMFICHE_ESERVICE ,
      NUMPAC ,
      ISUX ,
      MATRIC_ESCALADE ,
      COMRRH
    FROM HELPDESK_FICHE)';
    
    EXECUTE IMMEDIATE 'rename HELPDESK_FICHE to HELPDESK_FICHE_tmp';
    EXECUTE IMMEDIATE 'rename HELPDESK_FICHE_inter to HELPDESK_FICHE';
    
    EXECUTE IMMEDIATE 'DROP TABLE HELPDESK_FICHE_tmp';
    EXECUTE IMMEDIATE 'COMMIT' ;
   
END;
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=NOTIFICATIONINDICATOR=
ALTER TABLE HELPDESK_FICHE ADD NOTIFICATIONINDICATOR VARCHAR(5)
##
HELPDESK_FICHE
=SQL IFNOTEXIST=HELPDESK_FICHE=OBJET_ESERVICE=
ALTER TABLE HELPDESK_FICHE ADD OBJET_ESERVICE varchar2(100)

##
TAG_CHARSET=@€éèç
##
ADM_ADD_OR_UPDATE_VARSYS
=SQL=
CREATE OR REPLACE PROCEDURE "ADM_ADD_OR_UPDATE_VARSYS" (
pMODULE IN VARCHAR2,
pCODVAR IN VARCHAR2,
pVALVAR IN VARCHAR2,
pTYPVAR IN VARCHAR2,
pDESCRIPTION IN VARCHAR2)
IS
varsysok NUMBER;
BEGIN
/*
* Cette procédure permet de créer une nouvelle entrée dans la table SYS_VARSYS.
* Dans le cas où la varsys n'existe pas elle sera alors crée.
* Si cette variable existe déjà, dans ce cas, uniquement sa description sera mise à jour.
*/
SELECT COUNT (*)
INTO varsysok
FROM SYS_VARSYS
WHERE MODULE = pMODULE AND CODVAR = pCODVAR;
IF (varsysok = 0) THEN
INSERT INTO SYS_VARSYS(MODULE, CODVAR, VALVAR, TYPVAR, DESCRIPTION)
VALUES (pMODULE, pCODVAR, pVALVAR, pTYPVAR, pDESCRIPTION);
ELSE
UPDATE SYS_VARSYS SET DESCRIPTION = pDESCRIPTION WHERE CODVAR = pCODVAR and MODULE = pMODULE;
END IF;
END ADM_ADD_OR_UPDATE_VARSYS;
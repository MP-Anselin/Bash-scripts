##
TRG_META_WKF_ID_GEN_PAGE
=SQL=
CREATE OR REPLACE TRIGGER TRG_META_WKF_ID_GEN_PAGE 
BEFORE INSERT OR UPDATE ON META_WKF_OPERATION_ECRANS 
FOR EACH ROW 
BEGIN
  IF :NEW.TYPE_ECRAN IN ('RECH','RECAP') THEN
    IF :OLD.ID_GEN_PAGE IS NOT NULL THEN
      -- ID_GEN_PAGE a déjà une valeur : on la laisse !
      :NEW.ID_GEN_PAGE := :OLD.ID_GEN_PAGE;
    ELSIF :NEW.ID_GEN_PAGE IS NULL THEN
      -- ID_GEN_PAGE n'a pas de valeur, et on n'en fourni pas non plus : on la calcule
      :NEW.ID_GEN_PAGE := DBMS_RANDOM.STRING('X', 8);
    END IF;
  ELSE
    :NEW.ID_GEN_PAGE := NULL;
  END IF;
END; 

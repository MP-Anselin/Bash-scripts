##
TAG_CHARSET=@€ιθη
##
TRG_TGE_ABSENCES
=SQL=
CREATE OR REPLACE TRIGGER TRG_TGE_ABSENCES AFTER INSERT OR UPDATE ON TGE_ABSENCES FOR EACH ROW 
BEGIN
	IF INSERTING THEN
		DBMS_OUTPUT.PUT_LINE('SUBMIT'||:NEW.ID);
		INSERT INTO MP_EVENTS M (MATRIC,EVENT,CLE_SECONDAIRE,ACTION,DATE_MODIF) VALUES (:NEW.MATRIC,'timeOffRequest.submit',:NEW.ID,'C',CURRENT_TIMESTAMP); 
	ELSIF UPDATING AND :OLD.STATUT !='N' AND :NEW.STATUT ='N' AND :OLD.WKF_DOSNUM IS NOT NULL  THEN 
		DBMS_OUTPUT.PUT_LINE('CANCEL'||:OLD.ID);
		INSERT INTO MP_EVENTS M (MATRIC,EVENT,CLE_SECONDAIRE,ACTION,DATE_MODIF) VALUES (:OLD.MATRIC,'timeOffRequest.cancel',:OLD.ID,'S',CURRENT_TIMESTAMP); 
	END IF;
END;

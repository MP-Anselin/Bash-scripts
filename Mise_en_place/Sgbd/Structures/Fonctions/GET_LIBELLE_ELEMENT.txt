##
GET_LIBELLE_ELEMENT
=SQL=
CREATE OR REPLACE
  FUNCTION GET_LIBELLE_ELEMENT(
      p_nom_page VARCHAR2 ,
      p_niveau   NUMBER)
    RETURN VARCHAR2
  AS
    v_retour VARCHAR2 (50);
  BEGIN
  WITH ARBO_SCHEMA (CODE_ELEMENT, NIVEAU, LIBELLE, CODE_ASSO_PERE) AS
    (SELECT E.CODE_ELEMENT,
      E.NIVEAU,
      E.LIBELLE,
      S.CODE_ASSO_PERE
    FROM SYS_SCH_ELEMENT E,
      SYS_SCHEMAS S
    WHERE E.CODE_ELEMENT=S.CODE_ELT
    AND E.NIVEAU        =S.NIVEAU
    AND E.NOM_PAGE      =p_nom_page
    UNION ALL
    SELECT E.CODE_ELEMENT,
      E.NIVEAU,
      E.LIBELLE,
      S.CODE_ASSO_PERE
    FROM SYS_SCH_ELEMENT E,
      SYS_SCHEMAS S,
      ARBO_SCHEMA A
    WHERE E.CODE_ELEMENT=S.CODE_ELT
    AND E.NIVEAU        =S.NIVEAU
    AND S.CODE_ASSO     =A.CODE_ASSO_PERE
    )
  SELECT LIBELLE INTO v_retour FROM ARBO_SCHEMA WHERE NIVEAU=p_niveau;
  RETURN v_retour;
END GET_LIBELLE_ELEMENT; 

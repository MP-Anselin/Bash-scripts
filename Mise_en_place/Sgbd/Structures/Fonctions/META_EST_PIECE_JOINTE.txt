##
META_EST_PIECE_JOINTE
=SQL=
create or replace FUNCTION META_EST_PIECE_JOINTE 
(
  P_COMPANY_ID IN VARCHAR2
, P_NOM_DONNEE IN VARCHAR2 
, P_NOM_PAGE IN VARCHAR2 
)RETURN INTEGER IS

CURSOR CUR_PIECE
IS 
  SELECT MODE_SAISIE, NOM_PAGE
  FROM META_DONNEE_ECRAN 
  WHERE COMPANY_ID = p_company_id
  AND NOM_DONNEE = p_nom_donnee 
  AND NOM_PAGE IN ('*' , p_NOM_PAGE)
  ORDER BY NOM_PAGE DESC; 
  
 lignesRequetes CUR_PIECE%ROWTYPE; 
 
 BEGIN
  OPEN CUR_PIECE;
  LOOP
    FETCH CUR_PIECE INTO lignesRequetes; 
    EXIT WHEN CUR_PIECE%NOTFOUND;
      IF lignesRequetes.MODE_SAISIE = 'asynchroneUploadFile' THEN
        RETURN 1;
      ELSE 
        RETURN 0;
      END IF;
  END LOOP;
  CLOSE CUR_PIECE;
END META_EST_PIECE_JOINTE;

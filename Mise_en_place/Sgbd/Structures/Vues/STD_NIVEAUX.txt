##
TAG_CHARSET=@€ιθη
##
STD_NIVEAUX
==
CREATE OR REPLACE FORCE VIEW "STD_NIVEAUX" ("NIV", "CODNIV1", "LIBNIV1", "CODNIV2", "LIBNIV2", "CODNIV3", "LIBNIV3", "CODNIV4", "LIBNIV4", "CODNIV5", "LIBNIV5", "CODNIV6", "LIBNIV6", "CODTS", "DATE_OUV", "DATE_FERM", "EST_PREV", "NUMV", "NOMV", "COM", "CP", "SIGLE", "DISTRI", "SIREN", "NIC", "BTQ", "TYPV", "ETAT") AS   ( SELECT '1' AS niv, n.CODNIV1 , n.libniv1 , '' AS codniv2 , '' AS libniv2 , '' AS codniv3 , '' AS libniv3 , '' AS codniv4 , '' AS libniv4 , '' AS codniv5 , '' AS libniv5 , '' AS codniv6 , '' AS libniv6 , n.CODTS , DATE_OUV , DATE_FERM , EST_PREV , (SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 IS NULL) AS TYPV , ( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv1 n UNION ALL SELECT '2' AS niv, n.CODNIV1 , (SELECT LIBNIV1 FROM niv1 WHERE niv1.codniv1=n.codniv1 AND niv1.codts = n.codts) AS libniv1 , n.CODNIV2 , n.libniv2 , '' AS codniv3, '' AS libniv3, '' AS codniv4, '' AS libniv4, '' AS codniv5, '' AS libniv5, '' AS codniv6, '' AS libniv6, n.CODTS , DATE_OUV , DATE_FERM , EST_PREV , (SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 IS NULL) AS TYPV , ( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv2 n UNION ALL SELECT '3' AS niv, n.CODNIV1 , (SELECT LIBNIV1 FROM niv1 WHERE niv1.codniv1=n.codniv1 AND niv1.codts = n.codts) AS libniv1, n.CODNIV2 , (SELECT LIBNIV2 FROM niv2 WHERE niv2.codniv1=n.codniv1 AND niv2.codniv2 = n.codniv2 AND niv2.codts = n.codts) AS libniv2 , n.CODNIV3 , n.libniv3 , '' AS codniv4, '' AS libniv4, '' AS codniv5, '' AS libniv5, '' AS codniv6, '' AS libniv6, n.CODTS , DATE_OUV , DATE_FERM , EST_PREV ,(SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 IS NULL) AS TYPV , ( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv3 n UNION ALL SELECT '4' AS niv, n.CODNIV1 , (SELECT LIBNIV1 FROM niv1 WHERE niv1.codniv1=n.codniv1 AND niv1.codts = n.codts) AS libniv1, n.CODNIV2 , (SELECT LIBNIV2 FROM niv2 WHERE niv2.codniv1=n.codniv1 AND niv2.codniv2 = n.codniv2 AND niv2.codts = n.codts) AS libniv2, n.CODNIV3 , (SELECT LIBNIV3 FROM niv3 WHERE niv3.codniv1=n.codniv1 AND niv3.codniv2 = n.codniv2 AND niv3.codniv3 = n.codniv3 AND niv3.codts = n.codts) AS libniv3 , n.CODNIV4 , n.libniv4 , '' AS codniv5, '' AS libniv5, '' AS codniv6, '' AS libniv6, n.CODTS , DATE_OUV , DATE_FERM , EST_PREV , (SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 IS NULL) AS TYPV ,( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv4 n UNION ALL SELECT '5' AS niv, n.CODNIV1 , (SELECT LIBNIV1 FROM niv1 WHERE niv1.codniv1=n.codniv1 AND niv1.codts = n.codts) AS libniv1, n.CODNIV2 , (SELECT LIBNIV2 FROM niv2 WHERE niv2.codniv1=n.codniv1 AND niv2.codniv2 = n.codniv2 AND niv2.codts = n.codts) AS libniv2, n.CODNIV3 , (SELECT LIBNIV3 FROM niv3 WHERE niv3.codniv1=n.codniv1 AND niv3.codniv2 = n.codniv2 AND niv3.codniv3 = n.codniv3 AND niv3.codts = n.codts) AS libniv3, n.CODNIV4 , (SELECT LIBNIV4 FROM niv4 WHERE niv4.codniv1=n.codniv1 AND niv4.codniv2 = n.codniv2 AND niv4.codniv3 = n.codniv3 AND niv4.codniv4 = n.codniv4 AND niv4.codts = n.codts) AS libniv4 , n.CODNIV5 , n.libniv5 , '' AS codniv6, '' AS libniv6, n.CODTS , DATE_OUV , DATE_FERM , EST_PREV ,(SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 IS NULL) AS TYPV ,( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv5 n UNION ALL SELECT '6' AS niv, n.CODNIV1 , (SELECT LIBNIV1 FROM niv1 WHERE niv1.codniv1=n.codniv1 AND niv1.codts = n.codts) AS libniv1, n.CODNIV2 , (SELECT LIBNIV2 FROM niv2 WHERE niv2.codniv1=n.codniv1 AND niv2.codniv2 = n.codniv2 AND niv2.codts = n.codts) AS libniv2, n.CODNIV3 , (SELECT LIBNIV3 FROM niv3 WHERE niv3.codniv1=n.codniv1 AND niv3.codniv2 = n.codniv2 AND niv3.codniv3 = n.codniv3 AND niv3.codts = n.codts) AS libniv3, n.CODNIV4 , (SELECT LIBNIV4 FROM niv4 WHERE niv4.codniv1=n.codniv1 AND niv4.codniv2 = n.codniv2 AND niv4.codniv3 = n.codniv3 AND niv4.codniv4 = n.codniv4 AND niv4.codts = n.codts) AS libniv4, n.CODNIV5 , (SELECT LIBNIV5 FROM niv5 WHERE niv5.codniv1=n.codniv1 AND niv5.codniv2 = n.codniv2 AND niv5.codniv3 = n.codniv3 AND niv5.codniv4 = n.codniv4 AND niv5.codniv5 = n.codniv5 AND niv5.codts = n.codts) AS libniv5, n.CODNIV6 , n.LIBNIV6 , n.CODTS , DATE_OUV , DATE_FERM , EST_PREV , (SELECT MAX(NUMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS NUMV, (SELECT MAX(NOMV) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS NOMV, (SELECT MAX(COM) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS COM, (SELECT MAX(CP) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS CP, (SELECT MAX(SIGLE) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS SIGLE, (SELECT MAX(DISTRI) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS DISTRI, (SELECT MAX(SIREN) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS SIREN, (SELECT MAX(NIC) FROM STD_ADRSTR ad WHERE ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS NIC, (SELECT LIB FROM BTQ b,STD_ADRSTR ad WHERE b.COD=ad.BTQ AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS BTQ , (SELECT t.LIBELLE FROM STD_TYPE_VOIE t,STD_ADRSTR ad WHERE t.CODE=ad.TYPV AND ad.CODTS = n.CODTS AND ad.codniv1 = n.CODNIV1 AND ad.CODNIV2 = n.CODNIV2 AND ad.CODNIV3 = n.CODNIV3 AND ad.CODNIV4 = n.CODNIV4 AND ad.CODNIV5 = n.CODNIV5 AND ad.CODNIV6 = n.CODNIV6) AS TYPV ,( CASE WHEN Date_ouv <TO_CHAR(sysdate,'yyyymmdd') AND (date_Ferm>TO_CHAR(sysdate,'yyyymmdd') OR date_ferm IS NULL) THEN 'O' ELSE 'F' END) AS Etat FROM niv6 n)
##
STD_NIVEAUX
==
drop view STD_NIVEAUX

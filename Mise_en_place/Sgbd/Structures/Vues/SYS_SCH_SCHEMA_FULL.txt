##
SYS_SCH_SCHEMA_FULL
==
CREATE OR REPLACE FORCE VIEW "SYS_SCH_SCHEMA_FULL" (ROLE,THEME,CLASSEUR,LIBELLE,NOM_PAGE, DESCRIPTION, CODE_ROLE, PROFILS ) as (select  E2.LIBELLE as ROLE,E3.LIBELLE as THEME, E4.LIBELLE as CLASSEUR,  E5.LIBELLE  as LIBELLE,E5.NOM_PAGE as NOM_PAGE, E5.DESCRIPTION AS DESCRIPTION, E5.CODE_ROLE as CODE_ROLE , ( SELECT LISTAGG(PO.libelle||'('||PO.code_profil||')', ',') WITHIN GROUP (ORDER BY PO.code_profil)  FROM (select p.code_profil, nvl((select libelle from sys_sch_profil s where s.code_profil=p.code_profil),'PROFIL SUPPRIME') as libelle, p.nom_page  from sys_sch_profil_p p ) PO where PO.NOM_PAGE = E5.NOM_PAGE)  as PROFILS from SYS_SCH_ELEMENT E1, SYS_SCH_ELEMENT E2, SYS_SCH_ELEMENT E3, SYS_SCH_ELEMENT E4, SYS_SCH_ELEMENT E5, SYS_SCHEMAS S1, SYS_SCHEMAS S2, SYS_SCHEMAS S3, SYS_SCHEMAS S4, SYS_SCHEMAS S5 where S5.CODE_SCHEMA = -1 and S4.CODE_SCHEMA = -1 and S3.CODE_SCHEMA = -1 and S2.CODE_SCHEMA = -1 and S1.CODE_SCHEMA = -1 and S5.CODE_ELT = E5.CODE_ELEMENT and S5.NIVEAU = E5.NIVEAU and S4.CODE_ELT = E4.CODE_ELEMENT and S4.NIVEAU = E4.NIVEAU and S3.CODE_ELT = E3.CODE_ELEMENT and S3.NIVEAU = E3.NIVEAU and S2.CODE_ELT = E2.CODE_ELEMENT and S2.NIVEAU = E2.NIVEAU and S1.CODE_ELT = E1.CODE_ELEMENT and S1.NIVEAU = E1.NIVEAU and S5.NIVEAU ='99' and S4.NIVEAU ='4' and S3.NIVEAU ='3' and S2.NIVEAU ='2' and S1.NIVEAU ='1' and S5.CODE_ASSO_PERE = S4.CODE_ASSO and S4.CODE_ASSO_PERE = S3.CODE_ASSO and S3.CODE_ASSO_PERE = S2.CODE_ASSO and S2.CODE_ASSO_PERE = S1.CODE_ASSO)

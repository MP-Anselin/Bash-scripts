##
STD_RUBEPS
==
CREATE OR REPLACE FORCE VIEW "STD_RUBEPS" ("CODRUB", "FAMILL", "LIBFAM", "LIBTOT", "SENS", "AJOUT", "NAJOUT", "TAJOUT", "MAJOUT", "MODIF", "NMODIF", "TMODIF", "MMODIF", "REGUL", "NREGUL", "TREGUL", "MREGUL", "RESUL", "RESULG", "RESULC", "TRAIT", "SSREGL", "LIBRED", "TYPREG", "NUSEQU", "ALGO", "LIBALGO", "TYPRUB", "NATRUB", "GRPRUB", "DOMRUB", "DETRUB", "F01RUB", "F02RUB", "EDITN", "EDITT", "EDITM", "EDABS", "FERUB", "TYPENR", "SSCODE", "ISRAP") AS WITH T1 AS (SELECT  STD_FRUBRIQ.*,'P' AS TYPENR FROM STD_FRUBRIQ UNION SELECT  STD_FRUBRIQ.* ,'C' AS TYPENR FROM STD_FRUBRIQ ) SELECT T1."CODRUB",T1."FAMILL",T1."LIBFAM",T1."LIBTOT",T1."SENS",T1."AJOUT",T1."NAJOUT",T1."TAJOUT",T1."MAJOUT",T1."MODIF",T1."NMODIF",T1."TMODIF",T1."MMODIF",T1."REGUL",T1."NREGUL",T1."TREGUL",T1."MREGUL",T1."RESUL",T1."RESULG",T1."RESULC",T1."TRAIT",T1."SSREGL",T1."LIBRED",T1."TYPREG",T1."NUSEQU",T1."ALGO",T1."LIBALGO",T1."TYPRUB",T1."NATRUB",T1."GRPRUB",T1."DOMRUB",T1."DETRUB",T1."F01RUB",T1."F02RUB",T1."EDITN",T1."EDITT",T1."EDITM",T1."EDABS",T1."FERUB",T1."TYPENR" ,GAP_PARAM_SSCODE.COD AS SSCODE ,( CASE WHEN (T1.CODRUB IN (SELECT STD_RUBRETRO.RETREC FROM STD_RUBRETRO)) THEN 1 ELSE 0 END)  AS ISRAP FROM T1, GAP_PARAM_SSCODE WHERE T1.FAMILL = '5' UNION SELECT T1."CODRUB",T1."FAMILL",T1."LIBFAM",T1."LIBTOT",T1."SENS",T1."AJOUT",T1."NAJOUT",T1."TAJOUT",T1."MAJOUT",T1."MODIF",T1."NMODIF",T1."TMODIF",T1."MMODIF",T1."REGUL",T1."NREGUL",T1."TREGUL",T1."MREGUL",T1."RESUL",T1."RESULG",T1."RESULC",T1."TRAIT",T1."SSREGL",T1."LIBRED",T1."TYPREG",T1."NUSEQU",T1."ALGO",T1."LIBALGO",T1."TYPRUB",T1."NATRUB",T1."GRPRUB",T1."DOMRUB",T1."DETRUB",T1."F01RUB",T1."F02RUB",T1."EDITN",T1."EDITT",T1."EDITM",T1."EDABS",T1."FERUB",T1."TYPENR" ,' ' AS SSCODE ,( CASE WHEN (T1.CODRUB IN (SELECT STD_RUBRETRO.RETREC FROM STD_RUBRETRO)) THEN 1 ELSE 0 END)  AS ISRAP FROM T1 WHERE T1.FAMILL != '5' 
